"use strict";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable});keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=!0;var _d=!1;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=!0){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=!0;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function(){};return{s:F,n:function n(){if(i>=o.length)return{done:!0};return{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=!0,didErr=!1,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=!0;err=_e3},f:function f(){try{if(!normalCompletion&&it["return"]!=null)it["return"]()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}/**
 * KK Cabinets
 * @copyright 2020 Luke Zhang, Ethan Lim
 * @author luke zhang, Ethan Lim
 * 
 * https://luke-zhang-04.github.io
 * https://github.com/ethanlim04
 * 
 * @license
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */var data=new Map;var columnNum=0;var columns=$("#row").find(".responsive_column");var imgURL;var storageRef=storage.ref("gallery");var asyncFinished=!1;var filterOptions={colours:[],materials:[],furniture:["cabinets","countertop"],pattern:null,locations:[]};var activeFilters={colours:[],materials:[],cabinets:null,countertop:null,pattern:null,locations:[]};function contains(target,array){var _iterator=_createForOfIteratorHelper(array),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var i=_step.value;if(target===i){return!0}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!1}function arrayRemove(arr,value){return arr.filter(function(ele){return ele!=value})}db.collection("gallery").get().then(function(snapshot){var infoTypes=["colour","material","location"];snapshot.docs.forEach(function(doc){data[doc.id]=doc.data();var details=doc.data().details;var _iterator2=_createForOfIteratorHelper(infoTypes),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var infoType=_step2.value;if(!contains(details[infoType],filterOptions[infoType+"s"])){filterOptions[infoType+"s"].push(details[infoType])}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}});var _iterator3=_createForOfIteratorHelper(infoTypes.entries()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_slicedToArray(_step3.value,2),count=_step3$value[0],infoType=_step3$value[1];var _iterator4=_createForOfIteratorHelper(filterOptions[infoType+"s"]),_step4;try{var _loop=function(){var info=_step4.value;var id=info+"_"+infoType;$("#filter"+count).append("<button class=\"dropdown_menu\" id="+id+">"+info+"<span style=\"float: right;\" class=\"material-icons\">done</span></button>");var filter_name=info;var filter_type=infoType;if(id.includes(" ")){id="mixed_"+infoType}$("#"+id).click(function(){if(!contains(filter_name,activeFilters[filter_type+"s"])){activeFilters[filter_type+"s"].push(filter_name);$(this).find("span").text("clear")}else{activeFilters[filter_type+"s"]=arrayRemove(activeFilters[filter_type+"s"],filter_name);$(this).find("span").text("done")}})};for(_iterator4.s();!(_step4=_iterator4.n()).done;){_loop()}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}display_batch(data)});function display_batch(data){asyncFinished=!1;var _loop2=function(key){imgURL=storageRef.child(data[key]["file"]);var column=columns[columnNum%4];var id=key;imgURL.getDownloadURL().then(function(url){$(column).append("<div class=\"image_container\" id="+id+"><img onclick=\"expand("+id+")\"src=\""+url+"\"/></div>");var element=$("#"+id);var info="<br/>Colour: "+data[id]["details"]["colour"].charAt(0).toUpperCase()+data[id]["details"]["colour"].slice(1)+"<br/>Furniture: ";if(data[id]["details"]["furniture"]["countertop"]&&data[id]["details"]["furniture"]["cabinet"]){info+="Countertop and Cabinets "}else if(data[id]["details"]["furniture"]["cabinet"]){info+="Cabinets"}else if(data[id]["details"]["furniture"]["countertop"]){info+="Countertop"}info+="<br/>Location: "+data[id]["details"]["location"].charAt(0).toUpperCase()+data[id]["details"]["location"].slice(1);info+="<br/>Material: "+data[id]["details"]["material"].charAt(0).toUpperCase()+data[id]["details"]["material"].slice(1);info+="<br/>Pattern: "+(data[id]["details"]["pattern"]?"Yes":"None");element.append("<div class=\"details\"><p>"+info+"<p>")});columnNum++};for(var key in data){_loop2(key)}Promise.all(columns).then(function(){$("#loading").css("display","none")})}function expand(key){var element=document.getElementById(key);var container=element.getElementsByClassName("details")[0];if(container.style.maxHeight){container.style.maxHeight=null}else{container.style.maxHeight=container.scrollHeight+"px"}}function expand_filter(numb){var element=document.getElementById("filter"+numb);if(element.style.maxHeight){element.style.maxHeight=null}else{element.style.maxHeight=element.scrollHeight+"px"}}function apply_filters(){var filterTypes=["colour","material","location"];$(".image_container").remove();$("#loading").css("display","block");var filteredData=new Map;console.log(data,"DATA");for(var key in data){var doc=data[key];var broken=!1;var _iterator5=_createForOfIteratorHelper(filterTypes),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var filter=_step5.value;if(contains(doc["details"][filter],activeFilters[filter+"s"])){broken=!0;break}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}if(activeFilters["pattern"]!==null&&doc["details"]["pattern"]!==activeFilters["pattern"]){broken=!0}if(activeFilters["countertop"]!==null&&activeFilters["cabinets"]!==null){var match=doc["details"]["furniture"]["countertop"]!==activeFilters["countertop"]||doc["details"]["furniture"]["cabinet"]!==activeFilters["cabinets"];if(match){broken=!0}}if(!broken){filteredData[key]=doc}}display_batch(filteredData)}function clear_filters(){$(".image_container").remove();$("#loading").css("display","block");$(".dropdown_menu").each(function(){if($(this).find("span").text()=="clear"){$(this).find("span").text("done")}});$("#pattern_toggle").find("span").text("remove");activeFilters={colours:[],materials:[],cabinets:null,countertop:null,pattern:null,locations:[]};display_batch(data)}$("document").ready(function(){$("#pattern_toggle").click(function(){if($(this).find("span").text()==="remove"){$(this).find("span").text("clear");activeFilters["pattern"]=!1}else if($(this).find("span").text()==="clear"){$(this).find("span").text("done");activeFilters["pattern"]=!0}else if($(this).find("span").text()==="done"){$(this).find("span").text("remove");activeFilters["pattern"]=null}});var furniture_dropdowns=["either","both","countertop","cabinets"];$(".furniture_dropdown").each(function(){$(this).click(function(){var _iterator6=_createForOfIteratorHelper(furniture_dropdowns),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var i=_step6.value;$("#"+i+"_furniture").find("span").text("")}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}$(this).find("span").text("done");var id=$(this).attr("id");id=id.replace("_furniture","");console.log(id);if(id==="both"){activeFilters["cabinets"]=!0;activeFilters["countertop"]=!0}else if(id==="either"){activeFilters["cabinets"]=null;activeFilters["countertop"]=null}else if(id==="countertop"){activeFilters["cabinets"]=!1;activeFilters["countertop"]=!0}else if(id==="cabinets"){activeFilters["cabinets"]=!0;activeFilters["countertop"]=!1}console.log("activeFilters",activeFilters)})})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9nYWxsZXJ5LmpzIl0sIm5hbWVzIjpbImRhdGEiLCJNYXAiLCJjb2x1bW5OdW0iLCJjb2x1bW5zIiwiJCIsImZpbmQiLCJpbWdVUkwiLCJzdG9yYWdlUmVmIiwic3RvcmFnZSIsInJlZiIsImFzeW5jRmluaXNoZWQiLCJmaWx0ZXJPcHRpb25zIiwiY29sb3VycyIsIm1hdGVyaWFscyIsImZ1cm5pdHVyZSIsInBhdHRlcm4iLCJsb2NhdGlvbnMiLCJhY3RpdmVGaWx0ZXJzIiwiY2FiaW5ldHMiLCJjb3VudGVydG9wIiwiY29udGFpbnMiLCJ0YXJnZXQiLCJhcnJheSIsImkiLCJhcnJheVJlbW92ZSIsImFyciIsInZhbHVlIiwiZmlsdGVyIiwiZWxlIiwiZGIiLCJjb2xsZWN0aW9uIiwiZ2V0IiwidGhlbiIsInNuYXBzaG90IiwiaW5mb1R5cGVzIiwiZG9jcyIsImZvckVhY2giLCJkb2MiLCJpZCIsImRldGFpbHMiLCJpbmZvVHlwZSIsInB1c2giLCJlbnRyaWVzIiwiY291bnQiLCJpbmZvIiwiYXBwZW5kIiwiZmlsdGVyX25hbWUiLCJmaWx0ZXJfdHlwZSIsImluY2x1ZGVzIiwiY2xpY2siLCJ0ZXh0IiwiZGlzcGxheV9iYXRjaCIsImtleSIsImNoaWxkIiwiY29sdW1uIiwiZ2V0RG93bmxvYWRVUkwiLCJ1cmwiLCJlbGVtZW50IiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzbGljZSIsIlByb21pc2UiLCJhbGwiLCJjc3MiLCJleHBhbmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29udGFpbmVyIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInN0eWxlIiwibWF4SGVpZ2h0Iiwic2Nyb2xsSGVpZ2h0IiwiZXhwYW5kX2ZpbHRlciIsIm51bWIiLCJhcHBseV9maWx0ZXJzIiwiZmlsdGVyVHlwZXMiLCJyZW1vdmUiLCJmaWx0ZXJlZERhdGEiLCJjb25zb2xlIiwibG9nIiwiYnJva2VuIiwibWF0Y2giLCJjbGVhcl9maWx0ZXJz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QUFFLENBQUdsQyxDQUFDLENBQUMsSUFBRCxDQUFELENBQVFrRixJQUFSLENBQWEsSUFBYixDQUFULENBQ0FoRCxFQUFFLENBQUdBLEVBQUUsQ0FBQ2lELE9BQUgsQ0FBVyxZQUFYLENBQXlCLEVBQXpCLENBQUwsQ0FDQVQsT0FBTyxDQUFDQyxHQUFSLENBQVl6QyxFQUFaLEVBRUEsR0FBSUEsRUFBRSxHQUFLLE1BQVgsQ0FBbUIsQ0FDZnJCLGFBQWEsQ0FBQyxVQUFELENBQWIsSUFDQUEsYUFBYSxDQUFDLFlBQUQsQ0FBYixHQUVILENBSkQsSUFJTyxJQUFJcUIsRUFBRSxHQUFLLFFBQVgsQ0FBcUIsQ0FDeEJyQixhQUFhLENBQUMsVUFBRCxDQUFiLENBQTRCLElBQTVCLENBQ0FBLGFBQWEsQ0FBQyxZQUFELENBQWIsQ0FBOEIsSUFFakMsQ0FKTSxJQUlBLElBQUlxQixFQUFFLEdBQUssWUFBWCxDQUF5QixDQUM1QnJCLGFBQWEsQ0FBQyxVQUFELENBQWIsSUFDQUEsYUFBYSxDQUFDLFlBQUQsQ0FBYixHQUVILENBSk0sSUFJQSxJQUFJcUIsRUFBRSxHQUFLLFVBQVgsQ0FBdUIsQ0FDMUJyQixhQUFhLENBQUMsVUFBRCxDQUFiLElBQ0FBLGFBQWEsQ0FBQyxZQUFELENBQWIsR0FDSCxDQUNENkQsT0FBTyxDQUFDQyxHQUFSLENBQVksZUFBWixDQUE2QjlELGFBQTdCLENBQ0gsQ0ExQkQsQ0EyQkgsQ0E1QkQsQ0E2QkgsQ0FoREQiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEtLIENhYmluZXRzXG4gKiBAY29weXJpZ2h0IDIwMjAgTHVrZSBaaGFuZywgRXRoYW4gTGltXG4gKiBAYXV0aG9yIGx1a2UgemhhbmcsIEV0aGFuIExpbVxuICogXG4gKiBodHRwczovL2x1a2UtemhhbmctMDQuZ2l0aHViLmlvXG4gKiBodHRwczovL2dpdGh1Yi5jb20vZXRoYW5saW0wNFxuICogXG4gKiBAbGljZW5zZVxuICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbiAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG4gKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvclxuICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqIFxuICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZVxuICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqIFxuICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2VcbiAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LlxuICovXG5cbmxldCBkYXRhID0gbmV3IE1hcFxubGV0IGNvbHVtbk51bSA9IDBcbmxldCBjb2x1bW5zID0gJChcIiNyb3dcIikuZmluZChcIi5yZXNwb25zaXZlX2NvbHVtblwiKVxubGV0IGltZ1VSTFxubGV0IHN0b3JhZ2VSZWYgPSBzdG9yYWdlLnJlZihcImdhbGxlcnlcIilcbmxldCBhc3luY0ZpbmlzaGVkID0gZmFsc2VcblxuLy9nZXQgZmlsdGVyIG9wdGlvbnNcbmxldCBmaWx0ZXJPcHRpb25zID0ge1xuICAgIGNvbG91cnM6IFtdLFxuICAgIG1hdGVyaWFsczogW10sXG4gICAgZnVybml0dXJlOiBbXCJjYWJpbmV0c1wiLCBcImNvdW50ZXJ0b3BcIl0sXG4gICAgcGF0dGVybjogbnVsbCxcbiAgICBsb2NhdGlvbnM6IFtdXG59XG5cbi8vYWN0aXZlIGZpbHRlcnNcbmxldCBhY3RpdmVGaWx0ZXJzID0ge1xuICAgIGNvbG91cnM6IFtdLFxuICAgIG1hdGVyaWFsczogW10sXG4gICAgY2FiaW5ldHM6IG51bGwsXG4gICAgY291bnRlcnRvcDogbnVsbCxcbiAgICBwYXR0ZXJuOiBudWxsLFxuICAgIGxvY2F0aW9uczogW11cbn1cblxuLy9pZiBhcnJheSBjb25haW5zIHRhcmdldFxuZnVuY3Rpb24gY29udGFpbnModGFyZ2V0LCBhcnJheSkge1xuICAgIGZvciAoY29uc3QgaSBvZiBhcnJheSkge1xuICAgICAgICBpZiAodGFyZ2V0ID09PSBpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZVxufVxuXG4vL3JlbW92ZSBlbGVtZW50IGZyb20gYXJyYXlcbmZ1bmN0aW9uIGFycmF5UmVtb3ZlKGFyciwgdmFsdWUpIHtcbiAgICByZXR1cm4gYXJyLmZpbHRlcihmdW5jdGlvbihlbGUpe1xuICAgICAgICByZXR1cm4gZWxlICE9IHZhbHVlXG4gICAgfSlcbn1cblxuLy9nZXQgcHJvamVjdHMgZnJvbSBmaXJlc3RvcmVcbmRiLmNvbGxlY3Rpb24oXCJnYWxsZXJ5XCIpLmdldCgpLnRoZW4oKHNuYXBzaG90KSA9PiB7XG4gICAgY29uc3QgaW5mb1R5cGVzID0gW1wiY29sb3VyXCIsIFwibWF0ZXJpYWxcIiwgXCJsb2NhdGlvblwiXVxuICAgIHNuYXBzaG90LmRvY3MuZm9yRWFjaChkb2MgPT4ge1xuICAgICAgICBkYXRhW2RvYy5pZF0gPSBkb2MuZGF0YSgpXG5cbiAgICAgICAgLy9nZXQgYWxsIHBvc3NpYmxlIGZpbHRlciBvcHRpb25zXG4gICAgICAgIGxldCBkZXRhaWxzID0gZG9jLmRhdGEoKS5kZXRhaWxzXG4gICAgICAgIGZvciAoY29uc3QgaW5mb1R5cGUgb2YgaW5mb1R5cGVzKSB7XG4gICAgICAgICAgICAvL2lmIGZpbHRlciBjYXRlZ29yeSBub3QgaW5jbHVkZWQgeWV0LCBwdXNoIGl0XG4gICAgICAgICAgICBpZiAoIShjb250YWlucyhkZXRhaWxzW2luZm9UeXBlXSwgZmlsdGVyT3B0aW9uc1tpbmZvVHlwZStcInNcIl0pKSkge1xuICAgICAgICAgICAgICAgIGZpbHRlck9wdGlvbnNbaW5mb1R5cGUrXCJzXCJdLnB1c2goZGV0YWlsc1tpbmZvVHlwZV0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgLy9jcmVhdGUgYnV0dG9ucyBmb3IgZmlsdGVyaW5nXG4gICAgZm9yIChjb25zdCBbY291bnQsIGluZm9UeXBlXSBvZiBpbmZvVHlwZXMuZW50cmllcygpKSB7IC8vaXRlcmF0ZSB0aHJvdWdoIGVhY2ggZmlsdGVyIHR5cGVcbiAgICAgICAgZm9yIChjb25zdCBpbmZvIG9mIGZpbHRlck9wdGlvbnNbaW5mb1R5cGUrXCJzXCJdKSB7IC8vd2l0aGluIHRoZXNlIHR5cGVzLCBnZXQgYWxsIGZpbHRlciBvcHRpb25zXG4gICAgICAgICAgICBsZXQgaWQgPSBpbmZvICsgXCJfXCIgKyBpbmZvVHlwZSAvL3VuaXF1ZSBpZCBmb3IgZWFjaCBidXR0b25cbiAgICAgICAgICAgICQoXCIjZmlsdGVyXCIgKyBjb3VudCkuYXBwZW5kKCAvL2NyZWF0ZSBidXR0b24gZm9yIHNlbGV0aW5nIGZpbHRlclxuICAgICAgICAgICAgICAgIFwiPGJ1dHRvbiBjbGFzcz1cXFwiZHJvcGRvd25fbWVudVxcXCIgaWQ9XCIgKyBpZCArIFwiPlwiICsgaW5mbyArIFwiPHNwYW4gc3R5bGU9XFxcImZsb2F0OiByaWdodDtcXFwiIGNsYXNzPVxcXCJtYXRlcmlhbC1pY29uc1xcXCI+ZG9uZTwvc3Bhbj48L2J1dHRvbj5cIlxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgbGV0IGZpbHRlcl9uYW1lID0gaW5mb1xuICAgICAgICAgICAgbGV0IGZpbHRlcl90eXBlID0gaW5mb1R5cGVcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGlkLmluY2x1ZGVzKFwiIFwiKSkge1xuICAgICAgICAgICAgICAgIGlkID0gXCJtaXhlZF9cIiArIGluZm9UeXBlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQoXCIjXCIraWQpLmNsaWNrKGZ1bmN0aW9uKCkgeyAvL2NyZWF0ZSBldmVudCBsaXN0ZW5lciBmb3JcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRhaW5zKGZpbHRlcl9uYW1lLCBhY3RpdmVGaWx0ZXJzW2ZpbHRlcl90eXBlK1wic1wiXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tmaWx0ZXJfdHlwZStcInNcIl0ucHVzaChmaWx0ZXJfbmFtZSlcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KFwiY2xlYXJcIilcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW2ZpbHRlcl90eXBlK1wic1wiXSA9IGFycmF5UmVtb3ZlKGFjdGl2ZUZpbHRlcnNbZmlsdGVyX3R5cGUrXCJzXCJdLCBmaWx0ZXJfbmFtZSlcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KFwiZG9uZVwiKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzcGxheV9iYXRjaChkYXRhKVxufSlcblxuLy9oYW5kbGUgZGF0YSBhbmQgZGlzcGxheSBpbWFnZXMgYWNjb3JkaW5nbHlcbmZ1bmN0aW9uIGRpc3BsYXlfYmF0Y2goZGF0YSkge1xuICAgIGFzeW5jRmluaXNoZWQgPSBmYWxzZVxuICAgIGZvciAobGV0IGtleSBpbiBkYXRhKSB7XG4gICAgICAgIGltZ1VSTCA9IHN0b3JhZ2VSZWYuY2hpbGQoZGF0YVtrZXldW1wiZmlsZVwiXSkgLy9pbWFnZSB1cmxcbiAgICAgICAgbGV0IGNvbHVtbiA9IGNvbHVtbnNbY29sdW1uTnVtJTRdIC8vY29sdW1uIHRvIGFwcGVuZCBpbWFnZSB0b1xuICAgICAgICBsZXQgaWQgPSBrZXkgLy9mb3IgYXN5bmNocm9udXMgZ2V0RG93bmxvYWRVUkxcbiAgICAgICAgaW1nVVJMLmdldERvd25sb2FkVVJMKCkudGhlbihmdW5jdGlvbih1cmwpIHtcbiAgICAgICAgICAgIC8vYXBwZW5kIGltYWdlIHRvIGNvbHVtblxuICAgICAgICAgICAgJChjb2x1bW4pLmFwcGVuZCggXG4gICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPVxcXCJpbWFnZV9jb250YWluZXJcXFwiIGlkPVwiICsgaWQgKyBcIj48aW1nIG9uY2xpY2s9XFxcImV4cGFuZChcIiArIGlkICsgXCIpXFxcInNyYz1cXFwiXCIrIHVybCArIFwiXFxcIi8+PC9kaXY+XCJcbiAgICAgICAgICAgIClcblxuICAgICAgICAgICAgLy9hdHRhY2ggaW5mb3JtYXRpb24gdG8gaW1hZ2VcbiAgICAgICAgICAgIGxldCBlbGVtZW50ID0gJChcIiNcIiArIGlkKSAvL3Nob3J0Y3V0IGZvciB0YXJnZXQgZWxlbWVudFxuXG4gICAgICAgICAgICAvL3ZhcmlhYmxlIGZvciBpbmZvcm1hdGlvblxuICAgICAgICAgICAgbGV0IGluZm8gPSBcIjxici8+Q29sb3VyOiBcIiArIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImNvbG91clwiXS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImNvbG91clwiXS5zbGljZSgxKSArIFwiPGJyLz5GdXJuaXR1cmU6IFwiXG5cbiAgICAgICAgICAgIC8vZnVybml0dXJlIHR5cGVcbiAgICAgICAgICAgIGlmIChkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJmdXJuaXR1cmVcIl1bXCJjb3VudGVydG9wXCJdICYmIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImZ1cm5pdHVyZVwiXVtcImNhYmluZXRcIl0pIHtcbiAgICAgICAgICAgICAgICBpbmZvICs9IFwiQ291bnRlcnRvcCBhbmQgQ2FiaW5ldHMgXCJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YVtpZF1bXCJkZXRhaWxzXCJdW1wiZnVybml0dXJlXCJdW1wiY2FiaW5ldFwiXSkge1xuICAgICAgICAgICAgICAgIGluZm8gKz0gXCJDYWJpbmV0c1wiXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImZ1cm5pdHVyZVwiXVtcImNvdW50ZXJ0b3BcIl0pIHtcbiAgICAgICAgICAgICAgICBpbmZvICs9IFwiQ291bnRlcnRvcFwiXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vbG9jYXRpb25cbiAgICAgICAgICAgIGluZm8gKz0gXCI8YnIvPkxvY2F0aW9uOiBcIiArIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImxvY2F0aW9uXCJdLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgZGF0YVtpZF1bXCJkZXRhaWxzXCJdW1wibG9jYXRpb25cIl0uc2xpY2UoMSlcbiAgICAgICAgICAgIC8vbWF0ZXJpYWxcbiAgICAgICAgICAgIGluZm8gKz0gXCI8YnIvPk1hdGVyaWFsOiBcIiArIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcIm1hdGVyaWFsXCJdLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgZGF0YVtpZF1bXCJkZXRhaWxzXCJdW1wibWF0ZXJpYWxcIl0uc2xpY2UoMSlcbiAgICAgICAgICAgIC8vcGF0dGVyblxuICAgICAgICAgICAgaW5mbyArPSBcIjxici8+UGF0dGVybjogXCIgKyAoZGF0YVtpZF1bXCJkZXRhaWxzXCJdW1wicGF0dGVyblwiXSA/IFwiWWVzXCIgOiBcIk5vbmVcIilcblxuICAgICAgICAgICAgbGV0IHVzZXIgPSBudWxsXG4gICAgICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9XFxcImRldGFpbHNcXFwiPjxwPlwiICsgaW5mbyArIFwiPHA+XCIgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz1cXFwic2xpZGVcXFwiPlwiICsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8aW5wdXQgdHlwZT1cXFwicmFuZ2VcXFwiIG1pbj1cXFwiMFxcXCIgbWF4PVxcXCIxMFxcXCIgdmFsdWU9XFxcIjVcXFwiIGNsYXNzPVxcXCJzbGlkZXJcXFwiPlwiICsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8cD5SYXRpbmc6IDxzcGFuPjwvc3Bhbj48L3A+XCIgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCI8YnV0dG9uIGNsYXNzPVxcXCJidG4gYnRuLXN1Y2Nlc3NcXFwiPlN1Ym1pdDwvYnV0dG9uPlwiICsgXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCJcbiAgICAgICAgICAgICAgICApXG5cbiAgICAgICAgICAgICAgICAvL3NsaWRlclxuICAgICAgICAgICAgICAgIGxldCBzbGlkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZClcbiAgICAgICAgICAgICAgICAgICAgLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJzbGlkZVwiKVswXVxuICAgICAgICAgICAgICAgICAgICAuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKVswXVxuXG4gICAgICAgICAgICAgICAgLy9zbGlkZSB2YWx1ZVxuICAgICAgICAgICAgICAgIGxldCBvdXRwdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZClcbiAgICAgICAgICAgICAgICAgICAgLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJzbGlkZVwiKVswXVxuICAgICAgICAgICAgICAgICAgICAuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJwXCIpWzBdXG4gICAgICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNwYW5cIilbMF1cblxuICAgICAgICAgICAgICAgIC8vc3VibWl0IGJ1dHRvblxuICAgICAgICAgICAgICAgIGxldCBidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZClcbiAgICAgICAgICAgICAgICAgICAgLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJidG5cIilbMF1cblxuICAgICAgICAgICAgICAgIG91dHB1dC5pbm5lckhUTUwgPSBzbGlkZXIudmFsdWUvMlxuXG4gICAgICAgICAgICAgICAgc2xpZGVyLm9uaW5wdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0LmlubmVySFRNTCA9IHRoaXMudmFsdWUvMlxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgXyA9PiB7IC8vc3VibWl0IGJ1dHRvbiBmdW5jdGlvblxuICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSBzbGlkZXIudmFsdWUgLy92YWx1ZSBvZiBzbGlkZXJcblxuICAgICAgICAgICAgICAgICAgICAvL3JlYWQgXCJyYXRpbmdzXCIgZnJvbSBkYXRhYmFzZSBmb3IgdGhpcyB1c2VyXG4gICAgICAgICAgICAgICAgICAgIGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKFwiL3VzZXJzL1wiICsgdXNlcklkICsgXCIvcmF0aW5nc1wiKS5vbmNlKFwidmFsdWVcIikudGhlbihmdW5jdGlvbihzbmFwc2hvdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9zZXQgbmV3IHJhdGluZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByYXRpbmdzID0gbmV3IE1hcFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiBzbmFwc2hvdC52YWwoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdGluZ3NbaV0gPSBzbmFwc2hvdC52YWwoKVtpXVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmF0aW5nc1tpZF0gPSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoXCJ1c2Vycy9cIiArIHVzZXJJZCArIFwiL3JhdGluZ3NcIikuc2V0KHsgLy9wdXNoIHRvIGRhdGFiYXNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4ucmF0aW5nc1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2FwcGVuZCBpbmZvcm1hdGlvbiB0byBlbGVtZW50XG4gICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmQoXG4gICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz1cXFwiZGV0YWlsc1xcXCI+PHA+XCIgKyBpbmZvICsgXCI8cD5cIlxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgY29sdW1uTnVtKytcbiAgICB9XG4gICAgUHJvbWlzZS5hbGwoY29sdW1ucykudGhlbigoKSA9PiB7XG4gICAgICAgIC8vcmVtb3ZlIGxvYWRpbmcgZ2lmXG4gICAgICAgICQoXCIjbG9hZGluZ1wiKS5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKVxuICAgIH0pXG59XG5cbi8vbWFrZXMgaW5mb3JtYXRpb24gZHJvcCBkb3duXG5mdW5jdGlvbiBleHBhbmQoa2V5KSB7XG4gICAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChrZXkpXG4gICAgbGV0IGNvbnRhaW5lciA9IGVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImRldGFpbHNcIilbMF1cbiAgICBpZiAoY29udGFpbmVyLnN0eWxlLm1heEhlaWdodCl7XG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5tYXhIZWlnaHQgPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5tYXhIZWlnaHQgPSBjb250YWluZXIuc2Nyb2xsSGVpZ2h0ICsgXCJweFwiO1xuICAgIH1cbn1cblxuLy9leHBhbmQgZmlsdGVyIGRyb3Bkb3duXG5mdW5jdGlvbiBleHBhbmRfZmlsdGVyKG51bWIpIHtcbiAgICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZmlsdGVyXCIrbnVtYilcbiAgICBpZiAoZWxlbWVudC5zdHlsZS5tYXhIZWlnaHQpe1xuICAgICAgICBlbGVtZW50LnN0eWxlLm1heEhlaWdodCA9IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5zdHlsZS5tYXhIZWlnaHQgPSBlbGVtZW50LnNjcm9sbEhlaWdodCArIFwicHhcIjtcbiAgICB9XG59XG5cbi8vYXBwbHkgdGhlIGZpbHRlcnNcbmZ1bmN0aW9uIGFwcGx5X2ZpbHRlcnMoKSB7XG4gICAgY29uc3QgZmlsdGVyVHlwZXMgPSBbXCJjb2xvdXJcIiwgXCJtYXRlcmlhbFwiLCBcImxvY2F0aW9uXCJdIC8vZmlsdGVyIHJ0cGVzXG4gICAgJChcIi5pbWFnZV9jb250YWluZXJcIikucmVtb3ZlKCkgLy9nZXQgcmlkIG9mIGFsbCBpbWFnZXMgaW4gZ2FsbGVyeVxuICAgICQoXCIjbG9hZGluZ1wiKS5jc3MoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIikgLy9kaXNwbGF5IGxvYWRpbmcgZ2lmXG4gICAgbGV0IGZpbHRlcmVkRGF0YSA9IG5ldyBNYXAgLy9uZXcgbWFwIG9mIGZpbHRlcmVkIGRhdGFcbiAgICBjb25zb2xlLmxvZyhkYXRhLCBcIkRBVEFcIilcbiAgICBmb3IgKGxldCBrZXkgaW4gZGF0YSkgeyAvL2l0ZXJhdGUgdGhyb3VnaCBkYXRhXG4gICAgICAgIGxldCBkb2MgPSBkYXRhW2tleV1cbiAgICAgICAgbGV0IGJyb2tlbiA9IGZhbHNlXG4gICAgICAgIGZvciAoY29uc3QgZmlsdGVyIG9mIGZpbHRlclR5cGVzKSB7IC8vbWFrZSBzdXJlIGRvYyBkb2VzblwidCBoYXZlIGF0dHJpYnV0ZSBhc3Nvc2lhdGVkIHdpdGggYSBzZWxlY3RlZCBmaWx0ZXJcbiAgICAgICAgICAgIGlmIChjb250YWlucyhkb2NbXCJkZXRhaWxzXCJdW2ZpbHRlcl0sIGFjdGl2ZUZpbHRlcnNbZmlsdGVyK1wic1wiXSkpIHtcbiAgICAgICAgICAgICAgICBicm9rZW4gPSB0cnVlXG4gICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoYWN0aXZlRmlsdGVyc1tcInBhdHRlcm5cIl0gIT09IG51bGwgJiYgZG9jW1wiZGV0YWlsc1wiXVtcInBhdHRlcm5cIl0gIT09IGFjdGl2ZUZpbHRlcnNbXCJwYXR0ZXJuXCJdKSB7XG4gICAgICAgICAgICBicm9rZW4gPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGFjdGl2ZUZpbHRlcnNbXCJjb3VudGVydG9wXCJdICE9PSBudWxsICYmIGFjdGl2ZUZpbHRlcnNbXCJjYWJpbmV0c1wiXSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgbGV0IG1hdGNoID0gKFxuICAgICAgICAgICAgICAgIGRvY1tcImRldGFpbHNcIl1bXCJmdXJuaXR1cmVcIl1bXCJjb3VudGVydG9wXCJdICE9PSBhY3RpdmVGaWx0ZXJzW1wiY291bnRlcnRvcFwiXSB8fFxuICAgICAgICAgICAgICAgIGRvY1tcImRldGFpbHNcIl1bXCJmdXJuaXR1cmVcIl1bXCJjYWJpbmV0XCJdICE9PSBhY3RpdmVGaWx0ZXJzW1wiY2FiaW5ldHNcIl1cbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgICAgIGJyb2tlbiA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWJyb2tlbikgeyAvL2lmIGRhdGEgaXNuXCJ0IGZpbHRlcmVkLCBhZGQgaXQgdG8gZmlsdGVyZWQgZGF0YVxuICAgICAgICAgICAgZmlsdGVyZWREYXRhW2tleV0gPSBkb2NcbiAgICAgICAgfVxuICAgIH1cbiAgICBkaXNwbGF5X2JhdGNoKGZpbHRlcmVkRGF0YSkgLy9kaXNwbGF5IGZpbHRlcmVkIGRhdGFcbn1cblxuZnVuY3Rpb24gY2xlYXJfZmlsdGVycygpIHtcbiAgICAkKFwiLmltYWdlX2NvbnRhaW5lclwiKS5yZW1vdmUoKSAvL2dldCByaWQgb2YgYWxsIGltYWdlcyBpbiBnYWxsZXJ5XG4gICAgJChcIiNsb2FkaW5nXCIpLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKSAvL2Rpc3BsYXkgbG9hZGluZyBnaWZcbiAgICAkKFwiLmRyb3Bkb3duX21lbnVcIikuZWFjaChmdW5jdGlvbigpIHsgLy9jaGFuZ2UgYWxsIHggdG8gY2hlY2ttYXJrc1xuICAgICAgICBpZiAoJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KCkgPT0gXCJjbGVhclwiKSB7XG4gICAgICAgICAgICAkKHRoaXMpLmZpbmQoXCJzcGFuXCIpLnRleHQoXCJkb25lXCIpXG4gICAgICAgIH1cbiAgICB9KVxuICAgICQoXCIjcGF0dGVybl90b2dnbGVcIikuZmluZChcInNwYW5cIikudGV4dChcInJlbW92ZVwiKVxuICAgIC8vcmVzZXQgYWN0aXZlIGZpbHRlcnNcbiAgICBhY3RpdmVGaWx0ZXJzID0ge1xuICAgICAgICBjb2xvdXJzOiBbXSxcbiAgICAgICAgbWF0ZXJpYWxzOiBbXSxcbiAgICAgICAgY2FiaW5ldHM6IG51bGwsXG4gICAgICAgIGNvdW50ZXJ0b3A6IG51bGwsXG4gICAgICAgIHBhdHRlcm46IG51bGwsXG4gICAgICAgIGxvY2F0aW9uczogW11cbiAgICB9XG4gICAgZGlzcGxheV9iYXRjaChkYXRhKVxufVxuXG4kKFwiZG9jdW1lbnRcIikucmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgLy90b2dnbGVyIGZvciBwYXR0ZXJuIGZpdGxlclxuICAgICQoXCIjcGF0dGVybl90b2dnbGVcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICgkKHRoaXMpLmZpbmQoXCJzcGFuXCIpLnRleHQoKSA9PT0gXCJyZW1vdmVcIikgeyAvL2lmIGN1cnJlbnQgc2V0dGluZyBpcyBlaXRoZXIgb3JcbiAgICAgICAgICAgICQodGhpcykuZmluZChcInNwYW5cIikudGV4dChcImNsZWFyXCIpXG4gICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wicGF0dGVyblwiXSA9IGZhbHNlXG5cbiAgICAgICAgfSBlbHNlIGlmICgkKHRoaXMpLmZpbmQoXCJzcGFuXCIpLnRleHQoKSA9PT0gXCJjbGVhclwiKSB7IC8vaWYgY3VycmVudCBzZXR0aW5nIGlzIG5vIHBhdHRlcm5cbiAgICAgICAgICAgICQodGhpcykuZmluZChcInNwYW5cIikudGV4dChcImRvbmVcIilcbiAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJwYXR0ZXJuXCJdID0gdHJ1ZVxuXG4gICAgICAgIH0gZWxzZSBpZiAoJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KCkgPT09IFwiZG9uZVwiKSB7IC8vaWYgY3VycmVudCBzZXR0aW5nIGlzIHdpdGggYSBwYXR0ZXJuXG4gICAgICAgICAgICAkKHRoaXMpLmZpbmQoXCJzcGFuXCIpLnRleHQoXCJyZW1vdmVcIilcbiAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJwYXR0ZXJuXCJdID0gbnVsbFxuICAgICAgICB9XG4gICAgfSlcblxuICAgIC8vdG9nZ2xlciBmb3IgZnVybml0dXJlIHR5cGVzXG4gICAgY29uc3QgZnVybml0dXJlX2Ryb3Bkb3ducyA9IFtcImVpdGhlclwiLCBcImJvdGhcIiwgXCJjb3VudGVydG9wXCIsIFwiY2FiaW5ldHNcIl1cbiAgICAkKFwiLmZ1cm5pdHVyZV9kcm9wZG93blwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAkKHRoaXMpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIGZ1cm5pdHVyZV9kcm9wZG93bnMpIHtcbiAgICAgICAgICAgICAgICAkKFwiI1wiICsgaSArIFwiX2Z1cm5pdHVyZVwiKS5maW5kKFwic3BhblwiKS50ZXh0KFwiXCIpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkKHRoaXMpLmZpbmQoXCJzcGFuXCIpLnRleHQoXCJkb25lXCIpXG4gICAgICAgICAgICBsZXQgaWQgPSAkKHRoaXMpLmF0dHIoXCJpZFwiKVxuICAgICAgICAgICAgaWQgPSBpZC5yZXBsYWNlKFwiX2Z1cm5pdHVyZVwiLCBcIlwiKVxuICAgICAgICAgICAgY29uc29sZS5sb2coaWQpXG5cbiAgICAgICAgICAgIGlmIChpZCA9PT0gXCJib3RoXCIpIHsgLy9pZiBjdXJyZW50IHNldHRpbmcgaXMgYm90aCBjb3VudGVydG9wcyBhbmQgY2FiaW5ldHNcbiAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wiY2FiaW5ldHNcIl0gPSB0cnVlXG4gICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcImNvdW50ZXJ0b3BcIl0gPSB0cnVlXG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IFwiZWl0aGVyXCIpIHsgLy9pZiBjdXJyZW50IHNldHRpbmcgaXMgZWl0aGVyIGNvdW50ZXJ0b3BzIG9yIGNhYmluZXRzXG4gICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcImNhYmluZXRzXCJdID0gbnVsbFxuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJjb3VudGVydG9wXCJdID0gbnVsbFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gXCJjb3VudGVydG9wXCIpIHsgLy9pZiBjdXJyZW50IHNldHRpbmcgaXMgY291bnRlcnRvcHMgb25seVxuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJjYWJpbmV0c1wiXSA9IGZhbHNlXG4gICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcImNvdW50ZXJ0b3BcIl0gPSB0cnVlXG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IFwiY2FiaW5ldHNcIikgeyAvL2lmIGN1cnJlbnQgc2V0dGluZyBpcyBjYWJpbmV0cyBvbmx5XG4gICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcImNhYmluZXRzXCJdID0gdHJ1ZVxuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJjb3VudGVydG9wXCJdID0gZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWN0aXZlRmlsdGVyc1wiLCBhY3RpdmVGaWx0ZXJzKVxuICAgICAgICB9KVxuICAgIH0pXG59KSJdfQ==