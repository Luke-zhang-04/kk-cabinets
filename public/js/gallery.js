"use strict";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable});keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=!0;var _d=!1;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=!0){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=!0;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function(){};return{s:F,n:function n(){if(i>=o.length)return{done:!0};return{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=!0,didErr=!1,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=!0;err=_e3},f:function f(){try{if(!normalCompletion&&it["return"]!=null)it["return"]()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}/**
 * KK Cabinets
 * @copyright 2020 Luke Zhang, Ethan Lim
 * @author luke zhang, Ethan Lim
 * 
 * https://luke-zhang-04.github.io
 * https://github.com/ethanlim04
 * 
 * @license
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */var data=new Map;var columnNum=0;var columns=$("#row").find(".responsive_column");var imgURL;var storageRef=storage.ref("gallery");var asyncFinished=!1;var filterOptions={colours:[],materials:[],furniture:["cabinets","countertop"],pattern:null,locations:[]};var activeFilters={colours:[],materials:[],cabinets:null,countertop:null,pattern:null,locations:[]};function contains(target,array){var _iterator=_createForOfIteratorHelper(array),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var i=_step.value;if(target===i){return!0}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!1}function arrayRemove(arr,value){return arr.filter(function(ele){return ele!=value})}db.collection("gallery").get().then(function(snapshot){var infoTypes=["colour","material","location"];snapshot.docs.forEach(function(doc){data[doc.id]=doc.data();var details=doc.data().details;var _iterator2=_createForOfIteratorHelper(infoTypes),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var infoType=_step2.value;if(!contains(details[infoType],filterOptions[infoType+"s"])){filterOptions[infoType+"s"].push(details[infoType])}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}});var _iterator3=_createForOfIteratorHelper(infoTypes.entries()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_slicedToArray(_step3.value,2),count=_step3$value[0],infoType=_step3$value[1];var _iterator4=_createForOfIteratorHelper(filterOptions[infoType+"s"]),_step4;try{var _loop=function(){var info=_step4.value;var id=info+"_"+infoType;$("#filter"+count).append("<button class=\"dropdown_menu\" id="+id+">"+info+"<span style=\"float: right;\" class=\"material-icons\">done</span></button>");var filter_name=info;var filter_type=infoType;if(id.includes(" ")){id="mixed_"+infoType}$("#"+id).click(function(){if(!contains(filter_name,activeFilters[filter_type+"s"])){activeFilters[filter_type+"s"].push(filter_name);$(this).find("span").text("clear")}else{activeFilters[filter_type+"s"]=arrayRemove(activeFilters[filter_type+"s"],filter_name);$(this).find("span").text("done")}})};for(_iterator4.s();!(_step4=_iterator4.n()).done;){_loop()}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}display_batch(data)});function display_batch(data){asyncFinished=!1;var _loop2=function(key){imgURL=storageRef.child(data[key]["file"]);var column=columns[columnNum%4];var id=key;imgURL.getDownloadURL().then(function(url){$(column).append("<div class=\"image_container\" id="+id+"><img onclick=\"expand("+id+")\"src=\""+url+"\"/></div>");var element=$("#"+id);var info="<br/>Colour: "+data[id]["details"]["colour"].charAt(0).toUpperCase()+data[id]["details"]["colour"].slice(1)+"<br/>Furniture: ";if(data[id]["details"]["furniture"]["countertop"]&&data[id]["details"]["furniture"]["cabinet"]){info+="Countertop and Cabinets "}else if(data[id]["details"]["furniture"]["cabinet"]){info+="Cabinets"}else if(data[id]["details"]["furniture"]["countertop"]){info+="Countertop"}info+="<br/>Location: "+data[id]["details"]["location"].charAt(0).toUpperCase()+data[id]["details"]["location"].slice(1);info+="<br/>Material: "+data[id]["details"]["material"].charAt(0).toUpperCase()+data[id]["details"]["material"].slice(1);info+="<br/>Pattern: "+(data[id]["details"]["pattern"]?"Yes":"None");element.append("<div class=\"details\"><p>"+info+"<p>")});columnNum++};for(var key in data){_loop2(key)}Promise.all(columns).then(function(){$("#loading").css("display","none")})}function expand(key){var element=document.getElementById(key);var container=element.getElementsByClassName("details")[0];if(container.style.maxHeight){container.style.maxHeight=null}else{container.style.maxHeight=container.scrollHeight+"px"}}function expand_filter(numb){var element=document.getElementById("filter"+numb);if(element.style.maxHeight){element.style.maxHeight=null}else{element.style.maxHeight=element.scrollHeight+"px"}}function apply_filters(){var filterTypes=["colour","material","location"];$(".image_container").remove();$("#loading").css("display","block");var filteredData=new Map;for(var key in data){var doc=data[key];var broken=!1;var _iterator5=_createForOfIteratorHelper(filterTypes),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var filter=_step5.value;if(contains(doc["details"][filter],activeFilters[filter+"s"])){broken=!0;break}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}if(activeFilters["pattern"]!==null&&doc["details"]["pattern"]!==activeFilters["pattern"]){broken=!0}if(activeFilters["countertop"]!==null&&activeFilters["cabinets"]!==null){var match=doc["details"]["furniture"]["countertop"]!==activeFilters["countertop"]||doc["details"]["furniture"]["cabinet"]!==activeFilters["cabinets"];if(match){broken=!0}}if(!broken){filteredData[key]=doc}}display_batch(filteredData)}function clear_filters(){$(".image_container").remove();$("#loading").css("display","block");$(".dropdown_menu").each(function(){if($(this).find("span").text()=="clear"){$(this).find("span").text("done")}});$("#pattern_toggle").find("span").text("remove");activeFilters={colours:[],materials:[],cabinets:null,countertop:null,pattern:null,locations:[]};display_batch(data)}$("document").ready(function(){$("#pattern_toggle").click(function(){if($(this).find("span").text()==="remove"){$(this).find("span").text("clear");activeFilters["pattern"]=!1}else if($(this).find("span").text()==="clear"){$(this).find("span").text("done");activeFilters["pattern"]=!0}else if($(this).find("span").text()==="done"){$(this).find("span").text("remove");activeFilters["pattern"]=null}});var furniture_dropdowns=["either","both","countertop","cabinets"];$(".furniture_dropdown").each(function(){$(this).click(function(){var _iterator6=_createForOfIteratorHelper(furniture_dropdowns),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var i=_step6.value;$("#"+i+"_furniture").find("span").text("")}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}$(this).find("span").text("done");var id=$(this).attr("id");id=id.replace("_furniture","");if(id==="both"){activeFilters["cabinets"]=!0;activeFilters["countertop"]=!0}else if(id==="either"){activeFilters["cabinets"]=null;activeFilters["countertop"]=null}else if(id==="countertop"){activeFilters["cabinets"]=!1;activeFilters["countertop"]=!0}else if(id==="cabinets"){activeFilters["cabinets"]=!0;activeFilters["countertop"]=!1}})})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9nYWxsZXJ5LmpzIl0sIm5hbWVzIjpbImRhdGEiLCJNYXAiLCJjb2x1bW5OdW0iLCJjb2x1bW5zIiwiJCIsImZpbmQiLCJpbWdVUkwiLCJzdG9yYWdlUmVmIiwic3RvcmFnZSIsInJlZiIsImFzeW5jRmluaXNoZWQiLCJmaWx0ZXJPcHRpb25zIiwiY29sb3VycyIsIm1hdGVyaWFscyIsImZ1cm5pdHVyZSIsInBhdHRlcm4iLCJsb2NhdGlvbnMiLCJhY3RpdmVGaWx0ZXJzIiwiY2FiaW5ldHMiLCJjb3VudGVydG9wIiwiY29udGFpbnMiLCJ0YXJnZXQiLCJhcnJheSIsImkiLCJhcnJheVJlbW92ZSIsImFyciIsInZhbHVlIiwiZmlsdGVyIiwiZWxlIiwiZGIiLCJjb2xsZWN0aW9uIiwiZ2V0IiwidGhlbiIsInNuYXBzaG90IiwiaW5mb1R5cGVzIiwiZG9jcyIsImZvckVhY2giLCJkb2MiLCJpZCIsImRldGFpbHMiLCJpbmZvVHlwZSIsInB1c2giLCJlbnRyaWVzIiwiY291bnQiLCJpbmZvIiwiYXBwZW5kIiwiZmlsdGVyX25hbWUiLCJmaWx0ZXJfdHlwZSIsImluY2x1ZGVzIiwiY2xpY2siLCJ0ZXh0IiwiZGlzcGxheV9iYXRjaCIsImtleSIsImNoaWxkIiwiY29sdW1uIiwiZ2V0RG93bmxvYWRVUkwiLCJ1cmwiLCJlbGVtZW50IiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzbGljZSIsIlByb21pc2UiLCJhbGwiLCJjc3MiLCJleHBhbmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29udGFpbmVyIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInN0eWxlIiwibWF4SGVpZ2h0Iiwic2Nyb2xsSGVpZ2h0IiwiZXhwYW5kX2ZpbHRlciIsIm51bWIiLCJhcHBseV9maWx0ZXJzIiwiZmlsdGVyVHlwZXMiLCJyZW1vdmUiLCJmaWx0ZXJlZERhdGEiLCJicm9rZW4iLCJtYXRjaCIsImNsZWFyX2ZpbHRlcnMiLCJlYWNoIiwicmVhZHki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QyxFQUFFLENBQUdBLEVBQUUsQ0FBQytDLE9BQUgsQ0FBVyxZQUFYLENBQXlCLEVBQXpCLENBQUwsQ0FHQSxHQUFJL0MsRUFBRSxHQUFLLE1BQVgsQ0FBbUIsQ0FDZnJCLGFBQWEsQ0FBQyxVQUFELENBQWIsSUFDQUEsYUFBYSxDQUFDLFlBQUQsQ0FBYixHQUVILENBSkQsSUFJTyxJQUFJcUIsRUFBRSxHQUFLLFFBQVgsQ0FBcUIsQ0FDeEJyQixhQUFhLENBQUMsVUFBRCxDQUFiLENBQTRCLElBQTVCLENBQ0FBLGFBQWEsQ0FBQyxZQUFELENBQWIsQ0FBOEIsSUFFakMsQ0FKTSxJQUlBLElBQUlxQixFQUFFLEdBQUssWUFBWCxDQUF5QixDQUM1QnJCLGFBQWEsQ0FBQyxVQUFELENBQWIsSUFDQUEsYUFBYSxDQUFDLFlBQUQsQ0FBYixHQUVILENBSk0sSUFJQSxJQUFJcUIsRUFBRSxHQUFLLFVBQVgsQ0FBdUIsQ0FDMUJyQixhQUFhLENBQUMsVUFBRCxDQUFiLElBQ0FBLGFBQWEsQ0FBQyxZQUFELENBQWIsR0FDSCxDQUVKLENBMUJELENBMkJILENBNUJELENBNkJILENBaEREIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBLSyBDYWJpbmV0c1xuICogQGNvcHlyaWdodCAyMDIwIEx1a2UgWmhhbmcsIEV0aGFuIExpbVxuICogQGF1dGhvciBsdWtlIHpoYW5nLCBFdGhhbiBMaW1cbiAqIFxuICogaHR0cHM6Ly9sdWtlLXpoYW5nLTA0LmdpdGh1Yi5pb1xuICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGFubGltMDRcbiAqIFxuICogQGxpY2Vuc2VcbiAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5XG4gKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieVxuICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3JcbiAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKiBcbiAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2ZcbiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGVcbiAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG4gKiBcbiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlXG4gKiBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi5cbiAqL1xuXG5sZXQgZGF0YSA9IG5ldyBNYXBcbmxldCBjb2x1bW5OdW0gPSAwXG5sZXQgY29sdW1ucyA9ICQoXCIjcm93XCIpLmZpbmQoXCIucmVzcG9uc2l2ZV9jb2x1bW5cIilcbmxldCBpbWdVUkxcbmxldCBzdG9yYWdlUmVmID0gc3RvcmFnZS5yZWYoXCJnYWxsZXJ5XCIpXG5sZXQgYXN5bmNGaW5pc2hlZCA9IGZhbHNlXG5cbi8vZ2V0IGZpbHRlciBvcHRpb25zXG5sZXQgZmlsdGVyT3B0aW9ucyA9IHtcbiAgICBjb2xvdXJzOiBbXSxcbiAgICBtYXRlcmlhbHM6IFtdLFxuICAgIGZ1cm5pdHVyZTogW1wiY2FiaW5ldHNcIiwgXCJjb3VudGVydG9wXCJdLFxuICAgIHBhdHRlcm46IG51bGwsXG4gICAgbG9jYXRpb25zOiBbXVxufVxuXG4vL2FjdGl2ZSBmaWx0ZXJzXG5sZXQgYWN0aXZlRmlsdGVycyA9IHtcbiAgICBjb2xvdXJzOiBbXSxcbiAgICBtYXRlcmlhbHM6IFtdLFxuICAgIGNhYmluZXRzOiBudWxsLFxuICAgIGNvdW50ZXJ0b3A6IG51bGwsXG4gICAgcGF0dGVybjogbnVsbCxcbiAgICBsb2NhdGlvbnM6IFtdXG59XG5cbi8vaWYgYXJyYXkgY29uYWlucyB0YXJnZXRcbmZ1bmN0aW9uIGNvbnRhaW5zKHRhcmdldCwgYXJyYXkpIHtcbiAgICBmb3IgKGNvbnN0IGkgb2YgYXJyYXkpIHtcbiAgICAgICAgaWYgKHRhcmdldCA9PT0gaSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2Vcbn1cblxuLy9yZW1vdmUgZWxlbWVudCBmcm9tIGFycmF5XG5mdW5jdGlvbiBhcnJheVJlbW92ZShhcnIsIHZhbHVlKSB7XG4gICAgcmV0dXJuIGFyci5maWx0ZXIoZnVuY3Rpb24oZWxlKXtcbiAgICAgICAgcmV0dXJuIGVsZSAhPSB2YWx1ZVxuICAgIH0pXG59XG5cbi8vZ2V0IHByb2plY3RzIGZyb20gZmlyZXN0b3JlXG5kYi5jb2xsZWN0aW9uKFwiZ2FsbGVyeVwiKS5nZXQoKS50aGVuKChzbmFwc2hvdCkgPT4ge1xuICAgIGNvbnN0IGluZm9UeXBlcyA9IFtcImNvbG91clwiLCBcIm1hdGVyaWFsXCIsIFwibG9jYXRpb25cIl1cbiAgICBzbmFwc2hvdC5kb2NzLmZvckVhY2goZG9jID0+IHtcbiAgICAgICAgZGF0YVtkb2MuaWRdID0gZG9jLmRhdGEoKVxuXG4gICAgICAgIC8vZ2V0IGFsbCBwb3NzaWJsZSBmaWx0ZXIgb3B0aW9uc1xuICAgICAgICBsZXQgZGV0YWlscyA9IGRvYy5kYXRhKCkuZGV0YWlsc1xuICAgICAgICBmb3IgKGNvbnN0IGluZm9UeXBlIG9mIGluZm9UeXBlcykge1xuICAgICAgICAgICAgLy9pZiBmaWx0ZXIgY2F0ZWdvcnkgbm90IGluY2x1ZGVkIHlldCwgcHVzaCBpdFxuICAgICAgICAgICAgaWYgKCEoY29udGFpbnMoZGV0YWlsc1tpbmZvVHlwZV0sIGZpbHRlck9wdGlvbnNbaW5mb1R5cGUrXCJzXCJdKSkpIHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJPcHRpb25zW2luZm9UeXBlK1wic1wiXS5wdXNoKGRldGFpbHNbaW5mb1R5cGVdKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcblxuICAgIC8vY3JlYXRlIGJ1dHRvbnMgZm9yIGZpbHRlcmluZ1xuICAgIGZvciAoY29uc3QgW2NvdW50LCBpbmZvVHlwZV0gb2YgaW5mb1R5cGVzLmVudHJpZXMoKSkgeyAvL2l0ZXJhdGUgdGhyb3VnaCBlYWNoIGZpbHRlciB0eXBlXG4gICAgICAgIGZvciAoY29uc3QgaW5mbyBvZiBmaWx0ZXJPcHRpb25zW2luZm9UeXBlK1wic1wiXSkgeyAvL3dpdGhpbiB0aGVzZSB0eXBlcywgZ2V0IGFsbCBmaWx0ZXIgb3B0aW9uc1xuICAgICAgICAgICAgbGV0IGlkID0gaW5mbyArIFwiX1wiICsgaW5mb1R5cGUgLy91bmlxdWUgaWQgZm9yIGVhY2ggYnV0dG9uXG4gICAgICAgICAgICAkKFwiI2ZpbHRlclwiICsgY291bnQpLmFwcGVuZCggLy9jcmVhdGUgYnV0dG9uIGZvciBzZWxldGluZyBmaWx0ZXJcbiAgICAgICAgICAgICAgICBcIjxidXR0b24gY2xhc3M9XFxcImRyb3Bkb3duX21lbnVcXFwiIGlkPVwiICsgaWQgKyBcIj5cIiArIGluZm8gKyBcIjxzcGFuIHN0eWxlPVxcXCJmbG9hdDogcmlnaHQ7XFxcIiBjbGFzcz1cXFwibWF0ZXJpYWwtaWNvbnNcXFwiPmRvbmU8L3NwYW4+PC9idXR0b24+XCJcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIGxldCBmaWx0ZXJfbmFtZSA9IGluZm9cbiAgICAgICAgICAgIGxldCBmaWx0ZXJfdHlwZSA9IGluZm9UeXBlXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChpZC5pbmNsdWRlcyhcIiBcIikpIHtcbiAgICAgICAgICAgICAgICBpZCA9IFwibWl4ZWRfXCIgKyBpbmZvVHlwZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAkKFwiI1wiK2lkKS5jbGljayhmdW5jdGlvbigpIHsgLy9jcmVhdGUgZXZlbnQgbGlzdGVuZXIgZm9yXG4gICAgICAgICAgICAgICAgaWYgKCFjb250YWlucyhmaWx0ZXJfbmFtZSwgYWN0aXZlRmlsdGVyc1tmaWx0ZXJfdHlwZStcInNcIl0pKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbZmlsdGVyX3R5cGUrXCJzXCJdLnB1c2goZmlsdGVyX25hbWUpXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuZmluZChcInNwYW5cIikudGV4dChcImNsZWFyXCIpXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tmaWx0ZXJfdHlwZStcInNcIl0gPSBhcnJheVJlbW92ZShhY3RpdmVGaWx0ZXJzW2ZpbHRlcl90eXBlK1wic1wiXSwgZmlsdGVyX25hbWUpXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuZmluZChcInNwYW5cIikudGV4dChcImRvbmVcIilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuICAgIGRpc3BsYXlfYmF0Y2goZGF0YSlcbn0pXG5cbi8vaGFuZGxlIGRhdGEgYW5kIGRpc3BsYXkgaW1hZ2VzIGFjY29yZGluZ2x5XG5mdW5jdGlvbiBkaXNwbGF5X2JhdGNoKGRhdGEpIHtcbiAgICBhc3luY0ZpbmlzaGVkID0gZmFsc2VcbiAgICBmb3IgKGxldCBrZXkgaW4gZGF0YSkge1xuICAgICAgICBpbWdVUkwgPSBzdG9yYWdlUmVmLmNoaWxkKGRhdGFba2V5XVtcImZpbGVcIl0pIC8vaW1hZ2UgdXJsXG4gICAgICAgIGxldCBjb2x1bW4gPSBjb2x1bW5zW2NvbHVtbk51bSU0XSAvL2NvbHVtbiB0byBhcHBlbmQgaW1hZ2UgdG9cbiAgICAgICAgbGV0IGlkID0ga2V5IC8vZm9yIGFzeW5jaHJvbnVzIGdldERvd25sb2FkVVJMXG4gICAgICAgIGltZ1VSTC5nZXREb3dubG9hZFVSTCgpLnRoZW4oZnVuY3Rpb24odXJsKSB7XG4gICAgICAgICAgICAvL2FwcGVuZCBpbWFnZSB0byBjb2x1bW5cbiAgICAgICAgICAgICQoY29sdW1uKS5hcHBlbmQoIFxuICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz1cXFwiaW1hZ2VfY29udGFpbmVyXFxcIiBpZD1cIiArIGlkICsgXCI+PGltZyBvbmNsaWNrPVxcXCJleHBhbmQoXCIgKyBpZCArIFwiKVxcXCJzcmM9XFxcIlwiKyB1cmwgKyBcIlxcXCIvPjwvZGl2PlwiXG4gICAgICAgICAgICApXG5cbiAgICAgICAgICAgIC8vYXR0YWNoIGluZm9ybWF0aW9uIHRvIGltYWdlXG4gICAgICAgICAgICBsZXQgZWxlbWVudCA9ICQoXCIjXCIgKyBpZCkgLy9zaG9ydGN1dCBmb3IgdGFyZ2V0IGVsZW1lbnRcblxuICAgICAgICAgICAgLy92YXJpYWJsZSBmb3IgaW5mb3JtYXRpb25cbiAgICAgICAgICAgIGxldCBpbmZvID0gXCI8YnIvPkNvbG91cjogXCIgKyBkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJjb2xvdXJcIl0uY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJjb2xvdXJcIl0uc2xpY2UoMSkgKyBcIjxici8+RnVybml0dXJlOiBcIlxuXG4gICAgICAgICAgICAvL2Z1cm5pdHVyZSB0eXBlXG4gICAgICAgICAgICBpZiAoZGF0YVtpZF1bXCJkZXRhaWxzXCJdW1wiZnVybml0dXJlXCJdW1wiY291bnRlcnRvcFwiXSAmJiBkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJmdXJuaXR1cmVcIl1bXCJjYWJpbmV0XCJdKSB7XG4gICAgICAgICAgICAgICAgaW5mbyArPSBcIkNvdW50ZXJ0b3AgYW5kIENhYmluZXRzIFwiXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImZ1cm5pdHVyZVwiXVtcImNhYmluZXRcIl0pIHtcbiAgICAgICAgICAgICAgICBpbmZvICs9IFwiQ2FiaW5ldHNcIlxuICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJmdXJuaXR1cmVcIl1bXCJjb3VudGVydG9wXCJdKSB7XG4gICAgICAgICAgICAgICAgaW5mbyArPSBcIkNvdW50ZXJ0b3BcIlxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2xvY2F0aW9uXG4gICAgICAgICAgICBpbmZvICs9IFwiPGJyLz5Mb2NhdGlvbjogXCIgKyBkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJsb2NhdGlvblwiXS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImxvY2F0aW9uXCJdLnNsaWNlKDEpXG4gICAgICAgICAgICAvL21hdGVyaWFsXG4gICAgICAgICAgICBpbmZvICs9IFwiPGJyLz5NYXRlcmlhbDogXCIgKyBkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJtYXRlcmlhbFwiXS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcIm1hdGVyaWFsXCJdLnNsaWNlKDEpXG4gICAgICAgICAgICAvL3BhdHRlcm5cbiAgICAgICAgICAgIGluZm8gKz0gXCI8YnIvPlBhdHRlcm46IFwiICsgKGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcInBhdHRlcm5cIl0gPyBcIlllc1wiIDogXCJOb25lXCIpXG5cbiAgICAgICAgICAgIC8vIGxldCB1c2VyID0gZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyXG4gICAgICAgICAgICBsZXQgdXNlciA9IG51bGxcbiAgICAgICAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmQoXG4gICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz1cXFwiZGV0YWlsc1xcXCI+PHA+XCIgKyBpbmZvICsgXCI8cD5cIiArIFxuICAgICAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPVxcXCJzbGlkZVxcXCI+XCIgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjxpbnB1dCB0eXBlPVxcXCJyYW5nZVxcXCIgbWluPVxcXCIwXFxcIiBtYXg9XFxcIjEwXFxcIiB2YWx1ZT1cXFwiNVxcXCIgY2xhc3M9XFxcInNsaWRlclxcXCI+XCIgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjxwPlJhdGluZzogPHNwYW4+PC9zcGFuPjwvcD5cIiArIFxuICAgICAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxidXR0b24gY2xhc3M9XFxcImJ0biBidG4tc3VjY2Vzc1xcXCI+U3VibWl0PC9idXR0b24+XCIgKyBcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIlxuICAgICAgICAgICAgICAgIClcblxuICAgICAgICAgICAgICAgIC8vc2xpZGVyXG4gICAgICAgICAgICAgICAgbGV0IHNsaWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKVxuICAgICAgICAgICAgICAgICAgICAuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInNsaWRlXCIpWzBdXG4gICAgICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdXG5cbiAgICAgICAgICAgICAgICAvL3NsaWRlIHZhbHVlXG4gICAgICAgICAgICAgICAgbGV0IG91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKVxuICAgICAgICAgICAgICAgICAgICAuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInNsaWRlXCIpWzBdXG4gICAgICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInBcIilbMF1cbiAgICAgICAgICAgICAgICAgICAgLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic3BhblwiKVswXVxuXG4gICAgICAgICAgICAgICAgLy9zdWJtaXQgYnV0dG9uXG4gICAgICAgICAgICAgICAgbGV0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKVxuICAgICAgICAgICAgICAgICAgICAuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJ0blwiKVswXVxuXG4gICAgICAgICAgICAgICAgb3V0cHV0LmlubmVySFRNTCA9IHNsaWRlci52YWx1ZS8yXG5cbiAgICAgICAgICAgICAgICBzbGlkZXIub25pbnB1dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQuaW5uZXJIVE1MID0gdGhpcy52YWx1ZS8yXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBfID0+IHsgLy9zdWJtaXQgYnV0dG9uIGZ1bmN0aW9uXG4gICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IHNsaWRlci52YWx1ZSAvL3ZhbHVlIG9mIHNsaWRlclxuICAgICAgICAgICAgICAgICAgICAvLyB2YXIgdXNlcklkID0gZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyLnVpZCAvL2N1cnJlbnQgdXNlciBpZFxuXG4gICAgICAgICAgICAgICAgICAgIC8vcmVhZCBcInJhdGluZ3NcIiBmcm9tIGRhdGFiYXNlIGZvciB0aGlzIHVzZXJcbiAgICAgICAgICAgICAgICAgICAgZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoXCIvdXNlcnMvXCIgKyB1c2VySWQgKyBcIi9yYXRpbmdzXCIpLm9uY2UoXCJ2YWx1ZVwiKS50aGVuKGZ1bmN0aW9uKHNuYXBzaG90KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3NldCBuZXcgcmF0aW5nc1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJhdGluZ3MgPSBuZXcgTWFwXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluIHNuYXBzaG90LnZhbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmF0aW5nc1tpXSA9IHNuYXBzaG90LnZhbCgpW2ldXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByYXRpbmdzW2lkXSA9IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZihcInVzZXJzL1wiICsgdXNlcklkICsgXCIvcmF0aW5nc1wiKS5zZXQoeyAvL3B1c2ggdG8gZGF0YWJhc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5yYXRpbmdzXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vYXBwZW5kIGluZm9ybWF0aW9uIHRvIGVsZW1lbnRcbiAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZChcbiAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPVxcXCJkZXRhaWxzXFxcIj48cD5cIiArIGluZm8gKyBcIjxwPlwiXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBjb2x1bW5OdW0rK1xuICAgIH1cbiAgICBQcm9taXNlLmFsbChjb2x1bW5zKS50aGVuKCgpID0+IHtcbiAgICAgICAgLy9yZW1vdmUgbG9hZGluZyBnaWZcbiAgICAgICAgJChcIiNsb2FkaW5nXCIpLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpXG4gICAgfSlcbn1cblxuLy9tYWtlcyBpbmZvcm1hdGlvbiBkcm9wIGRvd25cbmZ1bmN0aW9uIGV4cGFuZChrZXkpIHtcbiAgICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGtleSlcbiAgICBsZXQgY29udGFpbmVyID0gZWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiZGV0YWlsc1wiKVswXVxuICAgIGlmIChjb250YWluZXIuc3R5bGUubWF4SGVpZ2h0KXtcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLm1heEhlaWdodCA9IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLm1heEhlaWdodCA9IGNvbnRhaW5lci5zY3JvbGxIZWlnaHQgKyBcInB4XCI7XG4gICAgfVxufVxuXG4vL2V4cGFuZCBmaWx0ZXIgZHJvcGRvd25cbmZ1bmN0aW9uIGV4cGFuZF9maWx0ZXIobnVtYikge1xuICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmaWx0ZXJcIitudW1iKVxuICAgIGlmIChlbGVtZW50LnN0eWxlLm1heEhlaWdodCl7XG4gICAgICAgIGVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50LnN0eWxlLm1heEhlaWdodCA9IGVsZW1lbnQuc2Nyb2xsSGVpZ2h0ICsgXCJweFwiO1xuICAgIH1cbn1cblxuLy9hcHBseSB0aGUgZmlsdGVyc1xuZnVuY3Rpb24gYXBwbHlfZmlsdGVycygpIHtcbiAgICBjb25zdCBmaWx0ZXJUeXBlcyA9IFtcImNvbG91clwiLCBcIm1hdGVyaWFsXCIsIFwibG9jYXRpb25cIl0gLy9maWx0ZXIgcnRwZXNcbiAgICAkKFwiLmltYWdlX2NvbnRhaW5lclwiKS5yZW1vdmUoKSAvL2dldCByaWQgb2YgYWxsIGltYWdlcyBpbiBnYWxsZXJ5XG4gICAgJChcIiNsb2FkaW5nXCIpLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKSAvL2Rpc3BsYXkgbG9hZGluZyBnaWZcbiAgICBsZXQgZmlsdGVyZWREYXRhID0gbmV3IE1hcCAvL25ldyBtYXAgb2YgZmlsdGVyZWQgZGF0YVxuICAgIGNvbnNvbGUubG9nKGRhdGEsIFwiREFUQVwiKVxuICAgIGZvciAobGV0IGtleSBpbiBkYXRhKSB7IC8vaXRlcmF0ZSB0aHJvdWdoIGRhdGFcbiAgICAgICAgbGV0IGRvYyA9IGRhdGFba2V5XVxuICAgICAgICBsZXQgYnJva2VuID0gZmFsc2VcbiAgICAgICAgZm9yIChjb25zdCBmaWx0ZXIgb2YgZmlsdGVyVHlwZXMpIHsgLy9tYWtlIHN1cmUgZG9jIGRvZXNuXCJ0IGhhdmUgYXR0cmlidXRlIGFzc29zaWF0ZWQgd2l0aCBhIHNlbGVjdGVkIGZpbHRlclxuICAgICAgICAgICAgaWYgKGNvbnRhaW5zKGRvY1tcImRldGFpbHNcIl1bZmlsdGVyXSwgYWN0aXZlRmlsdGVyc1tmaWx0ZXIrXCJzXCJdKSkge1xuICAgICAgICAgICAgICAgIGJyb2tlbiA9IHRydWVcbiAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChhY3RpdmVGaWx0ZXJzW1wicGF0dGVyblwiXSAhPT0gbnVsbCAmJiBkb2NbXCJkZXRhaWxzXCJdW1wicGF0dGVyblwiXSAhPT0gYWN0aXZlRmlsdGVyc1tcInBhdHRlcm5cIl0pIHtcbiAgICAgICAgICAgIGJyb2tlbiA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYWN0aXZlRmlsdGVyc1tcImNvdW50ZXJ0b3BcIl0gIT09IG51bGwgJiYgYWN0aXZlRmlsdGVyc1tcImNhYmluZXRzXCJdICE9PSBudWxsKSB7XG4gICAgICAgICAgICBsZXQgbWF0Y2ggPSAoXG4gICAgICAgICAgICAgICAgZG9jW1wiZGV0YWlsc1wiXVtcImZ1cm5pdHVyZVwiXVtcImNvdW50ZXJ0b3BcIl0gIT09IGFjdGl2ZUZpbHRlcnNbXCJjb3VudGVydG9wXCJdIHx8XG4gICAgICAgICAgICAgICAgZG9jW1wiZGV0YWlsc1wiXVtcImZ1cm5pdHVyZVwiXVtcImNhYmluZXRcIl0gIT09IGFjdGl2ZUZpbHRlcnNbXCJjYWJpbmV0c1wiXVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgYnJva2VuID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghYnJva2VuKSB7IC8vaWYgZGF0YSBpc25cInQgZmlsdGVyZWQsIGFkZCBpdCB0byBmaWx0ZXJlZCBkYXRhXG4gICAgICAgICAgICBmaWx0ZXJlZERhdGFba2V5XSA9IGRvY1xuICAgICAgICB9XG4gICAgfVxuICAgIGRpc3BsYXlfYmF0Y2goZmlsdGVyZWREYXRhKSAvL2Rpc3BsYXkgZmlsdGVyZWQgZGF0YVxufVxuXG5mdW5jdGlvbiBjbGVhcl9maWx0ZXJzKCkge1xuICAgICQoXCIuaW1hZ2VfY29udGFpbmVyXCIpLnJlbW92ZSgpIC8vZ2V0IHJpZCBvZiBhbGwgaW1hZ2VzIGluIGdhbGxlcnlcbiAgICAkKFwiI2xvYWRpbmdcIikuY3NzKFwiZGlzcGxheVwiLCBcImJsb2NrXCIpIC8vZGlzcGxheSBsb2FkaW5nIGdpZlxuICAgICQoXCIuZHJvcGRvd25fbWVudVwiKS5lYWNoKGZ1bmN0aW9uKCkgeyAvL2NoYW5nZSBhbGwgeCB0byBjaGVja21hcmtzXG4gICAgICAgIGlmICgkKHRoaXMpLmZpbmQoXCJzcGFuXCIpLnRleHQoKSA9PSBcImNsZWFyXCIpIHtcbiAgICAgICAgICAgICQodGhpcykuZmluZChcInNwYW5cIikudGV4dChcImRvbmVcIilcbiAgICAgICAgfVxuICAgIH0pXG4gICAgJChcIiNwYXR0ZXJuX3RvZ2dsZVwiKS5maW5kKFwic3BhblwiKS50ZXh0KFwicmVtb3ZlXCIpXG4gICAgLy9yZXNldCBhY3RpdmUgZmlsdGVyc1xuICAgIGFjdGl2ZUZpbHRlcnMgPSB7XG4gICAgICAgIGNvbG91cnM6IFtdLFxuICAgICAgICBtYXRlcmlhbHM6IFtdLFxuICAgICAgICBjYWJpbmV0czogbnVsbCxcbiAgICAgICAgY291bnRlcnRvcDogbnVsbCxcbiAgICAgICAgcGF0dGVybjogbnVsbCxcbiAgICAgICAgbG9jYXRpb25zOiBbXVxuICAgIH1cbiAgICBkaXNwbGF5X2JhdGNoKGRhdGEpXG59XG5cbiQoXCJkb2N1bWVudFwiKS5yZWFkeShmdW5jdGlvbigpIHtcbiAgICAvL3RvZ2dsZXIgZm9yIHBhdHRlcm4gZml0bGVyXG4gICAgJChcIiNwYXR0ZXJuX3RvZ2dsZVwiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCQodGhpcykuZmluZChcInNwYW5cIikudGV4dCgpID09PSBcInJlbW92ZVwiKSB7IC8vaWYgY3VycmVudCBzZXR0aW5nIGlzIGVpdGhlciBvclxuICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KFwiY2xlYXJcIilcbiAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJwYXR0ZXJuXCJdID0gZmFsc2VcblxuICAgICAgICB9IGVsc2UgaWYgKCQodGhpcykuZmluZChcInNwYW5cIikudGV4dCgpID09PSBcImNsZWFyXCIpIHsgLy9pZiBjdXJyZW50IHNldHRpbmcgaXMgbm8gcGF0dGVyblxuICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KFwiZG9uZVwiKVxuICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcInBhdHRlcm5cIl0gPSB0cnVlXG5cbiAgICAgICAgfSBlbHNlIGlmICgkKHRoaXMpLmZpbmQoXCJzcGFuXCIpLnRleHQoKSA9PT0gXCJkb25lXCIpIHsgLy9pZiBjdXJyZW50IHNldHRpbmcgaXMgd2l0aCBhIHBhdHRlcm5cbiAgICAgICAgICAgICQodGhpcykuZmluZChcInNwYW5cIikudGV4dChcInJlbW92ZVwiKVxuICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcInBhdHRlcm5cIl0gPSBudWxsXG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgLy90b2dnbGVyIGZvciBmdXJuaXR1cmUgdHlwZXNcbiAgICBjb25zdCBmdXJuaXR1cmVfZHJvcGRvd25zID0gW1wiZWl0aGVyXCIsIFwiYm90aFwiLCBcImNvdW50ZXJ0b3BcIiwgXCJjYWJpbmV0c1wiXVxuICAgICQoXCIuZnVybml0dXJlX2Ryb3Bkb3duXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICQodGhpcykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgZnVybml0dXJlX2Ryb3Bkb3ducykge1xuICAgICAgICAgICAgICAgICQoXCIjXCIgKyBpICsgXCJfZnVybml0dXJlXCIpLmZpbmQoXCJzcGFuXCIpLnRleHQoXCJcIilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICQodGhpcykuZmluZChcInNwYW5cIikudGV4dChcImRvbmVcIilcbiAgICAgICAgICAgIGxldCBpZCA9ICQodGhpcykuYXR0cihcImlkXCIpXG4gICAgICAgICAgICBpZCA9IGlkLnJlcGxhY2UoXCJfZnVybml0dXJlXCIsIFwiXCIpXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhpZClcblxuICAgICAgICAgICAgaWYgKGlkID09PSBcImJvdGhcIikgeyAvL2lmIGN1cnJlbnQgc2V0dGluZyBpcyBib3RoIGNvdW50ZXJ0b3BzIGFuZCBjYWJpbmV0c1xuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJjYWJpbmV0c1wiXSA9IHRydWVcbiAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wiY291bnRlcnRvcFwiXSA9IHRydWVcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gXCJlaXRoZXJcIikgeyAvL2lmIGN1cnJlbnQgc2V0dGluZyBpcyBlaXRoZXIgY291bnRlcnRvcHMgb3IgY2FiaW5ldHNcbiAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wiY2FiaW5ldHNcIl0gPSBudWxsXG4gICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcImNvdW50ZXJ0b3BcIl0gPSBudWxsXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSBcImNvdW50ZXJ0b3BcIikgeyAvL2lmIGN1cnJlbnQgc2V0dGluZyBpcyBjb3VudGVydG9wcyBvbmx5XG4gICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcImNhYmluZXRzXCJdID0gZmFsc2VcbiAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wiY291bnRlcnRvcFwiXSA9IHRydWVcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gXCJjYWJpbmV0c1wiKSB7IC8vaWYgY3VycmVudCBzZXR0aW5nIGlzIGNhYmluZXRzIG9ubHlcbiAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wiY2FiaW5ldHNcIl0gPSB0cnVlXG4gICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcImNvdW50ZXJ0b3BcIl0gPSBmYWxzZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJhY3RpdmVGaWx0ZXJzXCIsIGFjdGl2ZUZpbHRlcnMpXG4gICAgICAgIH0pXG4gICAgfSlcbn0pIl19