"use strict";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable});keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=!0;var _d=!1;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=!0){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=!0;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function(){};return{s:F,n:function n(){if(i>=o.length)return{done:!0};return{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=!0,didErr=!1,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=!0;err=_e3},f:function f(){try{if(!normalCompletion&&it["return"]!=null)it["return"]()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}/**
 * KK Cabinets
 * @copyright 2020 Luke Zhang, Ethan Lim
 * @author luke zhang, Ethan Lim
 * 
 * https://luke-zhang-04.github.io
 * https://github.com/ethanlim04
 * 
 * @license
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */var data=new Map;var columnNum=0;var columns=$("#row").find(".responsive_column");var imgURL;var storageRef=storage.ref("gallery");var asyncFinished=!1;var filterOptions={colours:[],materials:[],furniture:["cabinets","countertop"],pattern:null,locations:[]};var activeFilters={colours:[],materials:[],cabinets:null,countertop:null,pattern:null,locations:[]};function contains(target,array){var _iterator=_createForOfIteratorHelper(array),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var i=_step.value;if(target===i){return!0}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!1}function arrayRemove(arr,value){return arr.filter(function(ele){return ele!=value})}db.collection("gallery").get().then(function(snapshot){var infoTypes=["colour","material","location"];snapshot.docs.forEach(function(doc){data[doc.id]=doc.data();var details=doc.data().details;var _iterator2=_createForOfIteratorHelper(infoTypes),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var infoType=_step2.value;if(!contains(details[infoType],filterOptions[infoType+"s"])){filterOptions[infoType+"s"].push(details[infoType])}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}});var _iterator3=_createForOfIteratorHelper(infoTypes.entries()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_slicedToArray(_step3.value,2),count=_step3$value[0],infoType=_step3$value[1];var _iterator4=_createForOfIteratorHelper(filterOptions[infoType+"s"]),_step4;try{var _loop=function(){var info=_step4.value;var id=info+"_"+infoType;$("#filter"+count).append("<button class=\"dropdown_menu\" id="+id+">"+info+"<span style=\"float: right;\" class=\"material-icons\">done</span></button>");var filter_name=info;var filter_type=infoType;if(id.includes(" ")){id="mixed_"+infoType}$("#"+id).click(function(){if(!contains(filter_name,activeFilters[filter_type+"s"])){activeFilters[filter_type+"s"].push(filter_name);$(this).find("span").text("clear")}else{activeFilters[filter_type+"s"]=arrayRemove(activeFilters[filter_type+"s"],filter_name);$(this).find("span").text("done")}})};for(_iterator4.s();!(_step4=_iterator4.n()).done;){_loop()}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}display_batch(data)});function display_batch(data){asyncFinished=!1;var _loop2=function(key){imgURL=storageRef.child(data[key]["file"]);var column=columns[columnNum%4];var id=key;imgURL.getDownloadURL().then(function(url){$(column).append("<div class=\"image_container\" id="+id+"><img onclick=\"expand("+id+")\"src=\""+url+"\"/></div>");var element=$("#"+id);var info="<br/>Colour: "+data[id]["details"]["colour"].charAt(0).toUpperCase()+data[id]["details"]["colour"].slice(1)+"<br/>Furniture: ";if(data[id]["details"]["furniture"]["countertop"]&&data[id]["details"]["furniture"]["cabinet"]){info+="Countertop and Cabinets "}else if(data[id]["details"]["furniture"]["cabinet"]){info+="Cabinets"}else if(data[id]["details"]["furniture"]["countertop"]){info+="Countertop"}info+="<br/>Location: "+data[id]["details"]["location"].charAt(0).toUpperCase()+data[id]["details"]["location"].slice(1);info+="<br/>Material: "+data[id]["details"]["material"].charAt(0).toUpperCase()+data[id]["details"]["material"].slice(1);info+="<br/>Pattern: "+(data[id]["details"]["pattern"]?"Yes":"None");element.append("<div class=\"details\"><p>"+info+"<p>")});columnNum++};for(var key in data){_loop2(key)}Promise.all(columns).then(function(){$("#loading").css("display","none")})}function expand(key){var element=document.getElementById(key);var container=element.getElementsByClassName("details")[0];if(container.style.maxHeight){container.style.maxHeight=null}else{container.style.maxHeight=container.scrollHeight+"px"}}function expand_filter(numb){var element=document.getElementById("filter"+numb);if(element.style.maxHeight){element.style.maxHeight=null}else{element.style.maxHeight=element.scrollHeight+"px"}}function apply_filters(){var filterTypes=["colour","material","location"];$(".image_container").remove();$("#loading").css("display","block");var filteredData=new Map;for(var key in data){var doc=data[key];var broken=!1;var _iterator5=_createForOfIteratorHelper(filterTypes),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var filter=_step5.value;if(contains(doc["details"][filter],activeFilters[filter+"s"])){broken=!0;break}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}if(activeFilters["pattern"]!==null&&doc["details"]["pattern"]!==activeFilters["pattern"]){broken=!0}if(activeFilters["countertop"]!==null&&activeFilters["cabinets"]!==null){var match=doc["details"]["furniture"]["countertop"]!==activeFilters["countertop"]||doc["details"]["furniture"]["cabinet"]!==activeFilters["cabinets"];if(match){broken=!0}}if(!broken){filteredData[key]=doc}}display_batch(filteredData)}function clear_filters(){$(".image_container").remove();$("#loading").css("display","block");$(".dropdown_menu").each(function(){if($(this).find("span").text()=="clear"){$(this).find("span").text("done")}});$("#pattern_toggle").find("span").text("remove");activeFilters={colours:[],materials:[],cabinets:null,countertop:null,pattern:null,locations:[]};display_batch(data)}$("document").ready(function(){$("#pattern_toggle").click(function(){if($(this).find("span").text()==="remove"){$(this).find("span").text("clear");activeFilters["pattern"]=!1}else if($(this).find("span").text()==="clear"){$(this).find("span").text("done");activeFilters["pattern"]=!0}else if($(this).find("span").text()==="done"){$(this).find("span").text("remove");activeFilters["pattern"]=null}});var furniture_dropdowns=["either","both","countertop","cabinets"];$(".furniture_dropdown").each(function(){$(this).click(function(){var _iterator6=_createForOfIteratorHelper(furniture_dropdowns),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var i=_step6.value;$("#"+i+"_furniture").find("span").text("")}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}$(this).find("span").text("done");var id=$(this).attr("id");id=id.replace("_furniture","");if(id==="both"){activeFilters["cabinets"]=!0;activeFilters["countertop"]=!0}else if(id==="either"){activeFilters["cabinets"]=null;activeFilters["countertop"]=null}else if(id==="countertop"){activeFilters["cabinets"]=!1;activeFilters["countertop"]=!0}else if(id==="cabinets"){activeFilters["cabinets"]=!0;activeFilters["countertop"]=!1}})})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9nYWxsZXJ5LmpzIl0sIm5hbWVzIjpbImRhdGEiLCJNYXAiLCJjb2x1bW5OdW0iLCJjb2x1bW5zIiwiJCIsImZpbmQiLCJpbWdVUkwiLCJzdG9yYWdlUmVmIiwic3RvcmFnZSIsInJlZiIsImFzeW5jRmluaXNoZWQiLCJmaWx0ZXJPcHRpb25zIiwiY29sb3VycyIsIm1hdGVyaWFscyIsImZ1cm5pdHVyZSIsInBhdHRlcm4iLCJsb2NhdGlvbnMiLCJhY3RpdmVGaWx0ZXJzIiwiY2FiaW5ldHMiLCJjb3VudGVydG9wIiwiY29udGFpbnMiLCJ0YXJnZXQiLCJhcnJheSIsImkiLCJhcnJheVJlbW92ZSIsImFyciIsInZhbHVlIiwiZmlsdGVyIiwiZWxlIiwiZGIiLCJjb2xsZWN0aW9uIiwiZ2V0IiwidGhlbiIsInNuYXBzaG90IiwiaW5mb1R5cGVzIiwiZG9jcyIsImZvckVhY2giLCJkb2MiLCJpZCIsImRldGFpbHMiLCJpbmZvVHlwZSIsInB1c2giLCJlbnRyaWVzIiwiY291bnQiLCJpbmZvIiwiYXBwZW5kIiwiZmlsdGVyX25hbWUiLCJmaWx0ZXJfdHlwZSIsImluY2x1ZGVzIiwiY2xpY2siLCJ0ZXh0IiwiZGlzcGxheV9iYXRjaCIsImtleSIsImNoaWxkIiwiY29sdW1uIiwiZ2V0RG93bmxvYWRVUkwiLCJ1cmwiLCJlbGVtZW50IiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzbGljZSIsIlByb21pc2UiLCJhbGwiLCJjc3MiLCJleHBhbmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29udGFpbmVyIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInN0eWxlIiwibWF4SGVpZ2h0Iiwic2Nyb2xsSGVpZ2h0IiwiZXhwYW5kX2ZpbHRlciIsIm51bWIiLCJhcHBseV9maWx0ZXJzIiwiZmlsdGVyVHlwZXMiLCJyZW1vdmUiLCJmaWx0ZXJlZERhdGEiLCJicm9rZW4iLCJtYXRjaCIsImNsZWFyX2ZpbHRlcnMiLCJlYWNoIiwicmVhZHki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QyxFQUFFLENBQUdBLEVBQUUsQ0FBQytDLE9BQUgsQ0FBVyxZQUFYLENBQXlCLEVBQXpCLENBQUwsQ0FHQSxHQUFJL0MsRUFBRSxHQUFLLE1BQVgsQ0FBbUIsQ0FDZnJCLGFBQWEsQ0FBQyxVQUFELENBQWIsSUFDQUEsYUFBYSxDQUFDLFlBQUQsQ0FBYixHQUVILENBSkQsSUFJTyxJQUFJcUIsRUFBRSxHQUFLLFFBQVgsQ0FBcUIsQ0FDeEJyQixhQUFhLENBQUMsVUFBRCxDQUFiLENBQTRCLElBQTVCLENBQ0FBLGFBQWEsQ0FBQyxZQUFELENBQWIsQ0FBOEIsSUFFakMsQ0FKTSxJQUlBLElBQUlxQixFQUFFLEdBQUssWUFBWCxDQUF5QixDQUM1QnJCLGFBQWEsQ0FBQyxVQUFELENBQWIsSUFDQUEsYUFBYSxDQUFDLFlBQUQsQ0FBYixHQUVILENBSk0sSUFJQSxJQUFJcUIsRUFBRSxHQUFLLFVBQVgsQ0FBdUIsQ0FDMUJyQixhQUFhLENBQUMsVUFBRCxDQUFiLElBQ0FBLGFBQWEsQ0FBQyxZQUFELENBQWIsR0FDSCxDQUVKLENBMUJELENBMkJILENBNUJELENBNkJILENBaEREIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBLSyBDYWJpbmV0c1xuICogQGNvcHlyaWdodCAyMDIwIEx1a2UgWmhhbmcsIEV0aGFuIExpbVxuICogQGF1dGhvciBsdWtlIHpoYW5nLCBFdGhhbiBMaW1cbiAqIFxuICogaHR0cHM6Ly9sdWtlLXpoYW5nLTA0LmdpdGh1Yi5pb1xuICogaHR0cHM6Ly9naXRodWIuY29tL2V0aGFubGltMDRcbiAqIFxuICogQGxpY2Vuc2VcbiAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5XG4gKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieVxuICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3JcbiAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKiBcbiAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2ZcbiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGVcbiAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG4gKiBcbiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlXG4gKiBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi5cbiAqL1xuXG5sZXQgZGF0YSA9IG5ldyBNYXBcbmxldCBjb2x1bW5OdW0gPSAwXG5sZXQgY29sdW1ucyA9ICQoXCIjcm93XCIpLmZpbmQoXCIucmVzcG9uc2l2ZV9jb2x1bW5cIilcbmxldCBpbWdVUkxcbmxldCBzdG9yYWdlUmVmID0gc3RvcmFnZS5yZWYoXCJnYWxsZXJ5XCIpXG5sZXQgYXN5bmNGaW5pc2hlZCA9IGZhbHNlXG5cbi8vZ2V0IGZpbHRlciBvcHRpb25zXG5sZXQgZmlsdGVyT3B0aW9ucyA9IHtcbiAgICBjb2xvdXJzOiBbXSxcbiAgICBtYXRlcmlhbHM6IFtdLFxuICAgIGZ1cm5pdHVyZTogW1wiY2FiaW5ldHNcIiwgXCJjb3VudGVydG9wXCJdLFxuICAgIHBhdHRlcm46IG51bGwsXG4gICAgbG9jYXRpb25zOiBbXVxufVxuXG4vL2FjdGl2ZSBmaWx0ZXJzXG5sZXQgYWN0aXZlRmlsdGVycyA9IHtcbiAgICBjb2xvdXJzOiBbXSxcbiAgICBtYXRlcmlhbHM6IFtdLFxuICAgIGNhYmluZXRzOiBudWxsLFxuICAgIGNvdW50ZXJ0b3A6IG51bGwsXG4gICAgcGF0dGVybjogbnVsbCxcbiAgICBsb2NhdGlvbnM6IFtdXG59XG5cbi8vaWYgYXJyYXkgY29uYWlucyB0YXJnZXRcbmZ1bmN0aW9uIGNvbnRhaW5zKHRhcmdldCwgYXJyYXkpIHtcbiAgICBmb3IgKGNvbnN0IGkgb2YgYXJyYXkpIHtcbiAgICAgICAgaWYgKHRhcmdldCA9PT0gaSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2Vcbn1cblxuLy9yZW1vdmUgZWxlbWVudCBmcm9tIGFycmF5XG5mdW5jdGlvbiBhcnJheVJlbW92ZShhcnIsIHZhbHVlKSB7XG4gICAgcmV0dXJuIGFyci5maWx0ZXIoZnVuY3Rpb24oZWxlKXtcbiAgICAgICAgcmV0dXJuIGVsZSAhPSB2YWx1ZVxuICAgIH0pXG59XG5cbi8vZ2V0IHByb2plY3RzIGZyb20gZmlyZXN0b3JlXG5kYi5jb2xsZWN0aW9uKFwiZ2FsbGVyeVwiKS5nZXQoKS50aGVuKChzbmFwc2hvdCkgPT4ge1xuICAgIGNvbnN0IGluZm9UeXBlcyA9IFtcImNvbG91clwiLCBcIm1hdGVyaWFsXCIsIFwibG9jYXRpb25cIl1cbiAgICBzbmFwc2hvdC5kb2NzLmZvckVhY2goZG9jID0+IHtcbiAgICAgICAgZGF0YVtkb2MuaWRdID0gZG9jLmRhdGEoKVxuXG4gICAgICAgIC8vZ2V0IGFsbCBwb3NzaWJsZSBmaWx0ZXIgb3B0aW9uc1xuICAgICAgICBsZXQgZGV0YWlscyA9IGRvYy5kYXRhKCkuZGV0YWlsc1xuICAgICAgICBmb3IgKGNvbnN0IGluZm9UeXBlIG9mIGluZm9UeXBlcykge1xuICAgICAgICAgICAgLy9pZiBmaWx0ZXIgY2F0ZWdvcnkgbm90IGluY2x1ZGVkIHlldCwgcHVzaCBpdFxuICAgICAgICAgICAgaWYgKCEoY29udGFpbnMoZGV0YWlsc1tpbmZvVHlwZV0sIGZpbHRlck9wdGlvbnNbaW5mb1R5cGUrXCJzXCJdKSkpIHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJPcHRpb25zW2luZm9UeXBlK1wic1wiXS5wdXNoKGRldGFpbHNbaW5mb1R5cGVdKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcblxuICAgIC8vY3JlYXRlIGJ1dHRvbnMgZm9yIGZpbHRlcmluZ1xuICAgIGZvciAoY29uc3QgW2NvdW50LCBpbmZvVHlwZV0gb2YgaW5mb1R5cGVzLmVudHJpZXMoKSkgeyAvL2l0ZXJhdGUgdGhyb3VnaCBlYWNoIGZpbHRlciB0eXBlXG4gICAgICAgIGZvciAoY29uc3QgaW5mbyBvZiBmaWx0ZXJPcHRpb25zW2luZm9UeXBlK1wic1wiXSkgeyAvL3dpdGhpbiB0aGVzZSB0eXBlcywgZ2V0IGFsbCBmaWx0ZXIgb3B0aW9uc1xuICAgICAgICAgICAgbGV0IGlkID0gaW5mbyArIFwiX1wiICsgaW5mb1R5cGUgLy91bmlxdWUgaWQgZm9yIGVhY2ggYnV0dG9uXG4gICAgICAgICAgICAkKFwiI2ZpbHRlclwiICsgY291bnQpLmFwcGVuZCggLy9jcmVhdGUgYnV0dG9uIGZvciBzZWxldGluZyBmaWx0ZXJcbiAgICAgICAgICAgICAgICBcIjxidXR0b24gY2xhc3M9XFxcImRyb3Bkb3duX21lbnVcXFwiIGlkPVwiICsgaWQgKyBcIj5cIiArIGluZm8gKyBcIjxzcGFuIHN0eWxlPVxcXCJmbG9hdDogcmlnaHQ7XFxcIiBjbGFzcz1cXFwibWF0ZXJpYWwtaWNvbnNcXFwiPmRvbmU8L3NwYW4+PC9idXR0b24+XCJcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIGxldCBmaWx0ZXJfbmFtZSA9IGluZm9cbiAgICAgICAgICAgIGxldCBmaWx0ZXJfdHlwZSA9IGluZm9UeXBlXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChpZC5pbmNsdWRlcyhcIiBcIikpIHtcbiAgICAgICAgICAgICAgICBpZCA9IFwibWl4ZWRfXCIgKyBpbmZvVHlwZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAkKFwiI1wiK2lkKS5jbGljayhmdW5jdGlvbigpIHsgLy9jcmVhdGUgZXZlbnQgbGlzdGVuZXIgZm9yXG4gICAgICAgICAgICAgICAgaWYgKCFjb250YWlucyhmaWx0ZXJfbmFtZSwgYWN0aXZlRmlsdGVyc1tmaWx0ZXJfdHlwZStcInNcIl0pKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbZmlsdGVyX3R5cGUrXCJzXCJdLnB1c2goZmlsdGVyX25hbWUpXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuZmluZChcInNwYW5cIikudGV4dChcImNsZWFyXCIpXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tmaWx0ZXJfdHlwZStcInNcIl0gPSBhcnJheVJlbW92ZShhY3RpdmVGaWx0ZXJzW2ZpbHRlcl90eXBlK1wic1wiXSwgZmlsdGVyX25hbWUpXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuZmluZChcInNwYW5cIikudGV4dChcImRvbmVcIilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuICAgIGRpc3BsYXlfYmF0Y2goZGF0YSlcbn0pXG5cbi8vaGFuZGxlIGRhdGEgYW5kIGRpc3BsYXkgaW1hZ2VzIGFjY29yZGluZ2x5XG5mdW5jdGlvbiBkaXNwbGF5X2JhdGNoKGRhdGEpIHtcbiAgICBhc3luY0ZpbmlzaGVkID0gZmFsc2VcbiAgICBmb3IgKGxldCBrZXkgaW4gZGF0YSkge1xuICAgICAgICBpbWdVUkwgPSBzdG9yYWdlUmVmLmNoaWxkKGRhdGFba2V5XVtcImZpbGVcIl0pIC8vaW1hZ2UgdXJsXG4gICAgICAgIGxldCBjb2x1bW4gPSBjb2x1bW5zW2NvbHVtbk51bSU0XSAvL2NvbHVtbiB0byBhcHBlbmQgaW1hZ2UgdG9cbiAgICAgICAgbGV0IGlkID0ga2V5IC8vZm9yIGFzeW5jaHJvbnVzIGdldERvd25sb2FkVVJMXG4gICAgICAgIGltZ1VSTC5nZXREb3dubG9hZFVSTCgpLnRoZW4oZnVuY3Rpb24odXJsKSB7XG4gICAgICAgICAgICAvL2FwcGVuZCBpbWFnZSB0byBjb2x1bW5cbiAgICAgICAgICAgICQoY29sdW1uKS5hcHBlbmQoIFxuICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz1cXFwiaW1hZ2VfY29udGFpbmVyXFxcIiBpZD1cIiArIGlkICsgXCI+PGltZyBvbmNsaWNrPVxcXCJleHBhbmQoXCIgKyBpZCArIFwiKVxcXCJzcmM9XFxcIlwiKyB1cmwgKyBcIlxcXCIvPjwvZGl2PlwiXG4gICAgICAgICAgICApXG5cbiAgICAgICAgICAgIC8vYXR0YWNoIGluZm9ybWF0aW9uIHRvIGltYWdlXG4gICAgICAgICAgICBsZXQgZWxlbWVudCA9ICQoXCIjXCIgKyBpZCkgLy9zaG9ydGN1dCBmb3IgdGFyZ2V0IGVsZW1lbnRcblxuICAgICAgICAgICAgLy92YXJpYWJsZSBmb3IgaW5mb3JtYXRpb25cbiAgICAgICAgICAgIGxldCBpbmZvID0gXCI8YnIvPkNvbG91cjogXCIgKyBkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJjb2xvdXJcIl0uY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJjb2xvdXJcIl0uc2xpY2UoMSkgKyBcIjxici8+RnVybml0dXJlOiBcIlxuXG4gICAgICAgICAgICAvL2Z1cm5pdHVyZSB0eXBlXG4gICAgICAgICAgICBpZiAoZGF0YVtpZF1bXCJkZXRhaWxzXCJdW1wiZnVybml0dXJlXCJdW1wiY291bnRlcnRvcFwiXSAmJiBkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJmdXJuaXR1cmVcIl1bXCJjYWJpbmV0XCJdKSB7XG4gICAgICAgICAgICAgICAgaW5mbyArPSBcIkNvdW50ZXJ0b3AgYW5kIENhYmluZXRzIFwiXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImZ1cm5pdHVyZVwiXVtcImNhYmluZXRcIl0pIHtcbiAgICAgICAgICAgICAgICBpbmZvICs9IFwiQ2FiaW5ldHNcIlxuICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJmdXJuaXR1cmVcIl1bXCJjb3VudGVydG9wXCJdKSB7XG4gICAgICAgICAgICAgICAgaW5mbyArPSBcIkNvdW50ZXJ0b3BcIlxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2xvY2F0aW9uXG4gICAgICAgICAgICBpbmZvICs9IFwiPGJyLz5Mb2NhdGlvbjogXCIgKyBkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJsb2NhdGlvblwiXS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImxvY2F0aW9uXCJdLnNsaWNlKDEpXG4gICAgICAgICAgICAvL21hdGVyaWFsXG4gICAgICAgICAgICBpbmZvICs9IFwiPGJyLz5NYXRlcmlhbDogXCIgKyBkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJtYXRlcmlhbFwiXS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcIm1hdGVyaWFsXCJdLnNsaWNlKDEpXG4gICAgICAgICAgICAvL3BhdHRlcm5cbiAgICAgICAgICAgIGluZm8gKz0gXCI8YnIvPlBhdHRlcm46IFwiICsgKGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcInBhdHRlcm5cIl0gPyBcIlllc1wiIDogXCJOb25lXCIpXG5cbiAgICAgICAgICAgIGxldCB1c2VyID0gbnVsbFxuICAgICAgICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZChcbiAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPVxcXCJkZXRhaWxzXFxcIj48cD5cIiArIGluZm8gKyBcIjxwPlwiICsgXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9XFxcInNsaWRlXFxcIj5cIiArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGlucHV0IHR5cGU9XFxcInJhbmdlXFxcIiBtaW49XFxcIjBcXFwiIG1heD1cXFwiMTBcXFwiIHZhbHVlPVxcXCI1XFxcIiBjbGFzcz1cXFwic2xpZGVyXFxcIj5cIiArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPHA+UmF0aW5nOiA8c3Bhbj48L3NwYW4+PC9wPlwiICsgXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1zdWNjZXNzXFxcIj5TdWJtaXQ8L2J1dHRvbj5cIiArIFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAgICAgLy9zbGlkZXJcbiAgICAgICAgICAgICAgICBsZXQgc2xpZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpXG4gICAgICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwic2xpZGVcIilbMF1cbiAgICAgICAgICAgICAgICAgICAgLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIilbMF1cblxuICAgICAgICAgICAgICAgIC8vc2xpZGUgdmFsdWVcbiAgICAgICAgICAgICAgICBsZXQgb3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpXG4gICAgICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwic2xpZGVcIilbMF1cbiAgICAgICAgICAgICAgICAgICAgLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwicFwiKVswXVxuICAgICAgICAgICAgICAgICAgICAuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzcGFuXCIpWzBdXG5cbiAgICAgICAgICAgICAgICAvL3N1Ym1pdCBidXR0b25cbiAgICAgICAgICAgICAgICBsZXQgYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpXG4gICAgICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnRuXCIpWzBdXG5cbiAgICAgICAgICAgICAgICBvdXRwdXQuaW5uZXJIVE1MID0gc2xpZGVyLnZhbHVlLzJcblxuICAgICAgICAgICAgICAgIHNsaWRlci5vbmlucHV0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dC5pbm5lckhUTUwgPSB0aGlzLnZhbHVlLzJcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF8gPT4geyAvL3N1Ym1pdCBidXR0b24gZnVuY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gc2xpZGVyLnZhbHVlIC8vdmFsdWUgb2Ygc2xpZGVyXG5cbiAgICAgICAgICAgICAgICAgICAgLy9yZWFkIFwicmF0aW5nc1wiIGZyb20gZGF0YWJhc2UgZm9yIHRoaXMgdXNlclxuICAgICAgICAgICAgICAgICAgICBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZihcIi91c2Vycy9cIiArIHVzZXJJZCArIFwiL3JhdGluZ3NcIikub25jZShcInZhbHVlXCIpLnRoZW4oZnVuY3Rpb24oc25hcHNob3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc2V0IG5ldyByYXRpbmdzXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmF0aW5ncyA9IG5ldyBNYXBcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gc25hcHNob3QudmFsKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYXRpbmdzW2ldID0gc25hcHNob3QudmFsKClbaV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJhdGluZ3NbaWRdID0gdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKFwidXNlcnMvXCIgKyB1c2VySWQgKyBcIi9yYXRpbmdzXCIpLnNldCh7IC8vcHVzaCB0byBkYXRhYmFzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnJhdGluZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9hcHBlbmQgaW5mb3JtYXRpb24gdG8gZWxlbWVudFxuICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9XFxcImRldGFpbHNcXFwiPjxwPlwiICsgaW5mbyArIFwiPHA+XCJcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIGNvbHVtbk51bSsrXG4gICAgfVxuICAgIFByb21pc2UuYWxsKGNvbHVtbnMpLnRoZW4oKCkgPT4ge1xuICAgICAgICAvL3JlbW92ZSBsb2FkaW5nIGdpZlxuICAgICAgICAkKFwiI2xvYWRpbmdcIikuY3NzKFwiZGlzcGxheVwiLCBcIm5vbmVcIilcbiAgICB9KVxufVxuXG4vL21ha2VzIGluZm9ybWF0aW9uIGRyb3AgZG93blxuZnVuY3Rpb24gZXhwYW5kKGtleSkge1xuICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoa2V5KVxuICAgIGxldCBjb250YWluZXIgPSBlbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJkZXRhaWxzXCIpWzBdXG4gICAgaWYgKGNvbnRhaW5lci5zdHlsZS5tYXhIZWlnaHQpe1xuICAgICAgICBjb250YWluZXIuc3R5bGUubWF4SGVpZ2h0ID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb250YWluZXIuc3R5bGUubWF4SGVpZ2h0ID0gY29udGFpbmVyLnNjcm9sbEhlaWdodCArIFwicHhcIjtcbiAgICB9XG59XG5cbi8vZXhwYW5kIGZpbHRlciBkcm9wZG93blxuZnVuY3Rpb24gZXhwYW5kX2ZpbHRlcihudW1iKSB7XG4gICAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZpbHRlclwiK251bWIpXG4gICAgaWYgKGVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0KXtcbiAgICAgICAgZWxlbWVudC5zdHlsZS5tYXhIZWlnaHQgPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gZWxlbWVudC5zY3JvbGxIZWlnaHQgKyBcInB4XCI7XG4gICAgfVxufVxuXG4vL2FwcGx5IHRoZSBmaWx0ZXJzXG5mdW5jdGlvbiBhcHBseV9maWx0ZXJzKCkge1xuICAgIGNvbnN0IGZpbHRlclR5cGVzID0gW1wiY29sb3VyXCIsIFwibWF0ZXJpYWxcIiwgXCJsb2NhdGlvblwiXSAvL2ZpbHRlciBydHBlc1xuICAgICQoXCIuaW1hZ2VfY29udGFpbmVyXCIpLnJlbW92ZSgpIC8vZ2V0IHJpZCBvZiBhbGwgaW1hZ2VzIGluIGdhbGxlcnlcbiAgICAkKFwiI2xvYWRpbmdcIikuY3NzKFwiZGlzcGxheVwiLCBcImJsb2NrXCIpIC8vZGlzcGxheSBsb2FkaW5nIGdpZlxuICAgIGxldCBmaWx0ZXJlZERhdGEgPSBuZXcgTWFwIC8vbmV3IG1hcCBvZiBmaWx0ZXJlZCBkYXRhXG4gICAgY29uc29sZS5sb2coZGF0YSwgXCJEQVRBXCIpXG4gICAgZm9yIChsZXQga2V5IGluIGRhdGEpIHsgLy9pdGVyYXRlIHRocm91Z2ggZGF0YVxuICAgICAgICBsZXQgZG9jID0gZGF0YVtrZXldXG4gICAgICAgIGxldCBicm9rZW4gPSBmYWxzZVxuICAgICAgICBmb3IgKGNvbnN0IGZpbHRlciBvZiBmaWx0ZXJUeXBlcykgeyAvL21ha2Ugc3VyZSBkb2MgZG9lc25cInQgaGF2ZSBhdHRyaWJ1dGUgYXNzb3NpYXRlZCB3aXRoIGEgc2VsZWN0ZWQgZmlsdGVyXG4gICAgICAgICAgICBpZiAoY29udGFpbnMoZG9jW1wiZGV0YWlsc1wiXVtmaWx0ZXJdLCBhY3RpdmVGaWx0ZXJzW2ZpbHRlcitcInNcIl0pKSB7XG4gICAgICAgICAgICAgICAgYnJva2VuID0gdHJ1ZVxuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdGl2ZUZpbHRlcnNbXCJwYXR0ZXJuXCJdICE9PSBudWxsICYmIGRvY1tcImRldGFpbHNcIl1bXCJwYXR0ZXJuXCJdICE9PSBhY3RpdmVGaWx0ZXJzW1wicGF0dGVyblwiXSkge1xuICAgICAgICAgICAgYnJva2VuID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhY3RpdmVGaWx0ZXJzW1wiY291bnRlcnRvcFwiXSAhPT0gbnVsbCAmJiBhY3RpdmVGaWx0ZXJzW1wiY2FiaW5ldHNcIl0gIT09IG51bGwpIHtcbiAgICAgICAgICAgIGxldCBtYXRjaCA9IChcbiAgICAgICAgICAgICAgICBkb2NbXCJkZXRhaWxzXCJdW1wiZnVybml0dXJlXCJdW1wiY291bnRlcnRvcFwiXSAhPT0gYWN0aXZlRmlsdGVyc1tcImNvdW50ZXJ0b3BcIl0gfHxcbiAgICAgICAgICAgICAgICBkb2NbXCJkZXRhaWxzXCJdW1wiZnVybml0dXJlXCJdW1wiY2FiaW5ldFwiXSAhPT0gYWN0aXZlRmlsdGVyc1tcImNhYmluZXRzXCJdXG4gICAgICAgICAgICApXG4gICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICBicm9rZW4gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFicm9rZW4pIHsgLy9pZiBkYXRhIGlzblwidCBmaWx0ZXJlZCwgYWRkIGl0IHRvIGZpbHRlcmVkIGRhdGFcbiAgICAgICAgICAgIGZpbHRlcmVkRGF0YVtrZXldID0gZG9jXG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzcGxheV9iYXRjaChmaWx0ZXJlZERhdGEpIC8vZGlzcGxheSBmaWx0ZXJlZCBkYXRhXG59XG5cbmZ1bmN0aW9uIGNsZWFyX2ZpbHRlcnMoKSB7XG4gICAgJChcIi5pbWFnZV9jb250YWluZXJcIikucmVtb3ZlKCkgLy9nZXQgcmlkIG9mIGFsbCBpbWFnZXMgaW4gZ2FsbGVyeVxuICAgICQoXCIjbG9hZGluZ1wiKS5jc3MoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIikgLy9kaXNwbGF5IGxvYWRpbmcgZ2lmXG4gICAgJChcIi5kcm9wZG93bl9tZW51XCIpLmVhY2goZnVuY3Rpb24oKSB7IC8vY2hhbmdlIGFsbCB4IHRvIGNoZWNrbWFya3NcbiAgICAgICAgaWYgKCQodGhpcykuZmluZChcInNwYW5cIikudGV4dCgpID09IFwiY2xlYXJcIikge1xuICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KFwiZG9uZVwiKVxuICAgICAgICB9XG4gICAgfSlcbiAgICAkKFwiI3BhdHRlcm5fdG9nZ2xlXCIpLmZpbmQoXCJzcGFuXCIpLnRleHQoXCJyZW1vdmVcIilcbiAgICAvL3Jlc2V0IGFjdGl2ZSBmaWx0ZXJzXG4gICAgYWN0aXZlRmlsdGVycyA9IHtcbiAgICAgICAgY29sb3VyczogW10sXG4gICAgICAgIG1hdGVyaWFsczogW10sXG4gICAgICAgIGNhYmluZXRzOiBudWxsLFxuICAgICAgICBjb3VudGVydG9wOiBudWxsLFxuICAgICAgICBwYXR0ZXJuOiBudWxsLFxuICAgICAgICBsb2NhdGlvbnM6IFtdXG4gICAgfVxuICAgIGRpc3BsYXlfYmF0Y2goZGF0YSlcbn1cblxuJChcImRvY3VtZW50XCIpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgIC8vdG9nZ2xlciBmb3IgcGF0dGVybiBmaXRsZXJcbiAgICAkKFwiI3BhdHRlcm5fdG9nZ2xlXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KCkgPT09IFwicmVtb3ZlXCIpIHsgLy9pZiBjdXJyZW50IHNldHRpbmcgaXMgZWl0aGVyIG9yXG4gICAgICAgICAgICAkKHRoaXMpLmZpbmQoXCJzcGFuXCIpLnRleHQoXCJjbGVhclwiKVxuICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcInBhdHRlcm5cIl0gPSBmYWxzZVxuXG4gICAgICAgIH0gZWxzZSBpZiAoJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KCkgPT09IFwiY2xlYXJcIikgeyAvL2lmIGN1cnJlbnQgc2V0dGluZyBpcyBubyBwYXR0ZXJuXG4gICAgICAgICAgICAkKHRoaXMpLmZpbmQoXCJzcGFuXCIpLnRleHQoXCJkb25lXCIpXG4gICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wicGF0dGVyblwiXSA9IHRydWVcblxuICAgICAgICB9IGVsc2UgaWYgKCQodGhpcykuZmluZChcInNwYW5cIikudGV4dCgpID09PSBcImRvbmVcIikgeyAvL2lmIGN1cnJlbnQgc2V0dGluZyBpcyB3aXRoIGEgcGF0dGVyblxuICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KFwicmVtb3ZlXCIpXG4gICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wicGF0dGVyblwiXSA9IG51bGxcbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICAvL3RvZ2dsZXIgZm9yIGZ1cm5pdHVyZSB0eXBlc1xuICAgIGNvbnN0IGZ1cm5pdHVyZV9kcm9wZG93bnMgPSBbXCJlaXRoZXJcIiwgXCJib3RoXCIsIFwiY291bnRlcnRvcFwiLCBcImNhYmluZXRzXCJdXG4gICAgJChcIi5mdXJuaXR1cmVfZHJvcGRvd25cIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgJCh0aGlzKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBmdXJuaXR1cmVfZHJvcGRvd25zKSB7XG4gICAgICAgICAgICAgICAgJChcIiNcIiArIGkgKyBcIl9mdXJuaXR1cmVcIikuZmluZChcInNwYW5cIikudGV4dChcIlwiKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KFwiZG9uZVwiKVxuICAgICAgICAgICAgbGV0IGlkID0gJCh0aGlzKS5hdHRyKFwiaWRcIilcbiAgICAgICAgICAgIGlkID0gaWQucmVwbGFjZShcIl9mdXJuaXR1cmVcIiwgXCJcIilcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGlkKVxuXG4gICAgICAgICAgICBpZiAoaWQgPT09IFwiYm90aFwiKSB7IC8vaWYgY3VycmVudCBzZXR0aW5nIGlzIGJvdGggY291bnRlcnRvcHMgYW5kIGNhYmluZXRzXG4gICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcImNhYmluZXRzXCJdID0gdHJ1ZVxuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJjb3VudGVydG9wXCJdID0gdHJ1ZVxuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSBcImVpdGhlclwiKSB7IC8vaWYgY3VycmVudCBzZXR0aW5nIGlzIGVpdGhlciBjb3VudGVydG9wcyBvciBjYWJpbmV0c1xuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJjYWJpbmV0c1wiXSA9IG51bGxcbiAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wiY291bnRlcnRvcFwiXSA9IG51bGxcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IFwiY291bnRlcnRvcFwiKSB7IC8vaWYgY3VycmVudCBzZXR0aW5nIGlzIGNvdW50ZXJ0b3BzIG9ubHlcbiAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wiY2FiaW5ldHNcIl0gPSBmYWxzZVxuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJjb3VudGVydG9wXCJdID0gdHJ1ZVxuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSBcImNhYmluZXRzXCIpIHsgLy9pZiBjdXJyZW50IHNldHRpbmcgaXMgY2FiaW5ldHMgb25seVxuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJjYWJpbmV0c1wiXSA9IHRydWVcbiAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wiY291bnRlcnRvcFwiXSA9IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImFjdGl2ZUZpbHRlcnNcIiwgYWN0aXZlRmlsdGVycylcbiAgICAgICAgfSlcbiAgICB9KVxufSkiXX0=