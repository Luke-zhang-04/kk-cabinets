"use strict";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable});keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0})}else{obj[key]=value}return obj}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=!0;var _d=!1;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=!0){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=!0;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it;if(typeof Symbol==="undefined"||o[Symbol.iterator]==null){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function(){};return{s:F,n:function n(){if(i>=o.length)return{done:!0};return{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=!0,didErr=!1,err;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=!0;err=_e3},f:function f(){try{if(!normalCompletion&&it["return"]!=null)it["return"]()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}var data=new Map;var columnNum=0;var columns=$("#row").find(".responsive_column");var imgURL;var storageRef=storage.ref("gallery");var asyncFinished=!1;var filterOptions={colours:[],materials:[],furniture:["cabinets","countertop"],pattern:null,locations:[]};var activeFilters={colours:[],materials:[],cabinets:null,countertop:null,pattern:null,locations:[]};function contains(target,array){var _iterator=_createForOfIteratorHelper(array),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var i=_step.value;if(target===i){return!0}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!1}function arrayRemove(arr,value){return arr.filter(function(ele){return ele!=value})}db.collection("gallery").get().then(function(snapshot){var infoTypes=["colour","material","location"];snapshot.docs.forEach(function(doc){data[doc.id]=doc.data();var details=doc.data().details;var _iterator2=_createForOfIteratorHelper(infoTypes),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var infoType=_step2.value;if(!contains(details[infoType],filterOptions[infoType+"s"])){filterOptions[infoType+"s"].push(details[infoType])}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}});var _iterator3=_createForOfIteratorHelper(infoTypes.entries()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_slicedToArray(_step3.value,2),count=_step3$value[0],infoType=_step3$value[1];var _iterator4=_createForOfIteratorHelper(filterOptions[infoType+"s"]),_step4;try{var _loop=function(){var info=_step4.value;var id=info+"_"+infoType;$("#filter"+count).append("<button class=\"dropdown_menu\" id="+id+">"+info+"<span style=\"float: right;\" class=\"material-icons\">done</span></button>");var filter_name=info;var filter_type=infoType;if(id.includes(" ")){id="mixed_"+infoType}$("#"+id).click(function(){if(!contains(filter_name,activeFilters[filter_type+"s"])){activeFilters[filter_type+"s"].push(filter_name);$(this).find("span").text("clear")}else{activeFilters[filter_type+"s"]=arrayRemove(activeFilters[filter_type+"s"],filter_name);$(this).find("span").text("done")}})};for(_iterator4.s();!(_step4=_iterator4.n()).done;){_loop()}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}display_batch(data)});function display_batch(data){asyncFinished=!1;var _loop2=function(key){imgURL=storageRef.child(data[key]["file"]);var column=columns[columnNum%4];var id=key;imgURL.getDownloadURL().then(function(url){$(column).append("<div class=\"image_container\" id="+id+"><img onclick=\"expand("+id+")\"src=\""+url+"\"/></div>");var element=$("#"+id);var info="<br/>Colour: "+data[id]["details"]["colour"].charAt(0).toUpperCase()+data[id]["details"]["colour"].slice(1)+"<br/>Furniture: ";if(data[id]["details"]["furniture"]["countertop"]&&data[id]["details"]["furniture"]["cabinet"]){info+="Countertop and Cabinets "}else if(data[id]["details"]["furniture"]["cabinet"]){info+="Cabinets"}else if(data[id]["details"]["furniture"]["countertop"]){info+="Countertop"}info+="<br/>Location: "+data[id]["details"]["location"].charAt(0).toUpperCase()+data[id]["details"]["location"].slice(1);info+="<br/>Material: "+data[id]["details"]["material"].charAt(0).toUpperCase()+data[id]["details"]["material"].slice(1);info+="<br/>Pattern: "+(data[id]["details"]["pattern"]?"Yes":"None");element.append("<div class=\"details\"><p>"+info+"<p>")});columnNum++};for(var key in data){_loop2(key)}Promise.all(columns).then(function(){$("#loading").css("display","none")})}function expand(key){var element=document.getElementById(key);var container=element.getElementsByClassName("details")[0];if(container.style.maxHeight){container.style.maxHeight=null}else{container.style.maxHeight=container.scrollHeight+"px"}}function expand_filter(numb){var element=document.getElementById("filter"+numb);if(element.style.maxHeight){element.style.maxHeight=null}else{element.style.maxHeight=element.scrollHeight+"px"}}function apply_filters(){var filterTypes=["colour","material","location"];$(".image_container").remove();$("#loading").css("display","block");var filteredData=new Map;for(var key in data){var doc=data[key];var broken=!1;var _iterator5=_createForOfIteratorHelper(filterTypes),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var filter=_step5.value;if(contains(doc["details"][filter],activeFilters[filter+"s"])){broken=!0;break}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}if(activeFilters["pattern"]!==null&&doc["details"]["pattern"]!==activeFilters["pattern"]){broken=!0}if(activeFilters["countertop"]!==null&&activeFilters["cabinets"]!==null){var match=doc["details"]["furniture"]["countertop"]!==activeFilters["countertop"]||doc["details"]["furniture"]["cabinet"]!==activeFilters["cabinets"];if(match){broken=!0}}if(!broken){filteredData[key]=doc}}display_batch(filteredData)}function clear_filters(){$(".image_container").remove();$("#loading").css("display","block");$(".dropdown_menu").each(function(){if($(this).find("span").text()=="clear"){$(this).find("span").text("done")}});$("#pattern_toggle").find("span").text("remove");activeFilters={colours:[],materials:[],cabinets:null,countertop:null,pattern:null,locations:[]};display_batch(data)}$("document").ready(function(){$("#pattern_toggle").click(function(){if($(this).find("span").text()==="remove"){$(this).find("span").text("clear");activeFilters["pattern"]=!1}else if($(this).find("span").text()==="clear"){$(this).find("span").text("done");activeFilters["pattern"]=!0}else if($(this).find("span").text()==="done"){$(this).find("span").text("remove");activeFilters["pattern"]=null}});var furniture_dropdowns=["either","both","countertop","cabinets"];$(".furniture_dropdown").each(function(){$(this).click(function(){var _iterator6=_createForOfIteratorHelper(furniture_dropdowns),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var i=_step6.value;$("#"+i+"_furniture").find("span").text("")}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}$(this).find("span").text("done");var id=$(this).attr("id");id=id.replace("_furniture","");if(id==="both"){activeFilters["cabinets"]=!0;activeFilters["countertop"]=!0}else if(id==="either"){activeFilters["cabinets"]=null;activeFilters["countertop"]=null}else if(id==="countertop"){activeFilters["cabinets"]=!1;activeFilters["countertop"]=!0}else if(id==="cabinets"){activeFilters["cabinets"]=!0;activeFilters["countertop"]=!1}})})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2pzL2dhbGxlcnkuanMiXSwibmFtZXMiOlsiZGF0YSIsIk1hcCIsImNvbHVtbk51bSIsImNvbHVtbnMiLCIkIiwiZmluZCIsImltZ1VSTCIsInN0b3JhZ2VSZWYiLCJzdG9yYWdlIiwicmVmIiwiYXN5bmNGaW5pc2hlZCIsImZpbHRlck9wdGlvbnMiLCJjb2xvdXJzIiwibWF0ZXJpYWxzIiwiZnVybml0dXJlIiwicGF0dGVybiIsImxvY2F0aW9ucyIsImFjdGl2ZUZpbHRlcnMiLCJjYWJpbmV0cyIsImNvdW50ZXJ0b3AiLCJjb250YWlucyIsInRhcmdldCIsImFycmF5IiwiaSIsImFycmF5UmVtb3ZlIiwiYXJyIiwidmFsdWUiLCJmaWx0ZXIiLCJlbGUiLCJkYiIsImNvbGxlY3Rpb24iLCJnZXQiLCJ0aGVuIiwic25hcHNob3QiLCJpbmZvVHlwZXMiLCJkb2NzIiwiZm9yRWFjaCIsImRvYyIsImlkIiwiZGV0YWlscyIsImluZm9UeXBlIiwicHVzaCIsImVudHJpZXMiLCJjb3VudCIsImluZm8iLCJhcHBlbmQiLCJmaWx0ZXJfbmFtZSIsImZpbHRlcl90eXBlIiwiaW5jbHVkZXMiLCJjbGljayIsInRleHQiLCJkaXNwbGF5X2JhdGNoIiwia2V5IiwiY2hpbGQiLCJjb2x1bW4iLCJnZXREb3dubG9hZFVSTCIsInVybCIsImVsZW1lbnQiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInNsaWNlIiwiUHJvbWlzZSIsImFsbCIsImNzcyIsImV4cGFuZCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjb250YWluZXIiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwic3R5bGUiLCJtYXhIZWlnaHQiLCJzY3JvbGxIZWlnaHQiLCJleHBhbmRfZmlsdGVyIiwibnVtYiIsImFwcGx5X2ZpbHRlcnMiLCJmaWx0ZXJUeXBlcyIsInJlbW92ZSIsImZpbHRlcmVkRGF0YSIsImJyb2tlbiIsIm1hdGNoIiwiY2xlYXJfZmlsdGVycyIsImVhY2giLCJyZWFkeSIs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QUFILENBQVcsWUFBWCxDQUF5QixFQUF6QixDQUFMLENBR0EsR0FBSS9DLEVBQUUsR0FBSyxNQUFYLENBQW1CLENBQ2ZyQixhQUFhLENBQUMsVUFBRCxDQUFiLElBQ0FBLGFBQWEsQ0FBQyxZQUFELENBQWIsR0FFSCxDQUpELElBSU8sSUFBSXFCLEVBQUUsR0FBSyxRQUFYLENBQXFCLENBQ3hCckIsYUFBYSxDQUFDLFVBQUQsQ0FBYixDQUE0QixJQUE1QixDQUNBQSxhQUFhLENBQUMsWUFBRCxDQUFiLENBQThCLElBRWpDLENBSk0sSUFJQSxJQUFJcUIsRUFBRSxHQUFLLFlBQVgsQ0FBeUIsQ0FDNUJyQixhQUFhLENBQUMsVUFBRCxDQUFiLElBQ0FBLGFBQWEsQ0FBQyxZQUFELENBQWIsR0FFSCxDQUpNLElBSUEsSUFBSXFCLEVBQUUsR0FBSyxVQUFYLENBQXVCLENBQzFCckIsYUFBYSxDQUFDLFVBQUQsQ0FBYixJQUNBQSxhQUFhLENBQUMsWUFBRCxDQUFiLEdBQ0gsQ0FFSixDQTFCRCxDQTJCSCxDQTVCRCxDQTZCSCxDQWhERCIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5cdEtLIENhYmluZXRzXG4gICAgQ29weXJpZ2h0IChDKSAyMDIwICBMdWtlIFpoYW5nLCBFdGhhbiBMaW1cbiAgICBcbiAgICBodHRwczovL2x1a2UtemhhbmctMDQuZ2l0aHViLmlvXG4gICAgaHR0cHM6Ly9naXRodWIuY29tL2V0aGFubGltMDRcblxuICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5XG4gICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnlcbiAgICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvclxuICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG5cbiAgICBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbiAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGVcbiAgICBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuXG4gICAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2VcbiAgICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi5cbiovXG5cbmxldCBkYXRhID0gbmV3IE1hcFxubGV0IGNvbHVtbk51bSA9IDBcbmxldCBjb2x1bW5zID0gJChcIiNyb3dcIikuZmluZChcIi5yZXNwb25zaXZlX2NvbHVtblwiKVxubGV0IGltZ1VSTFxubGV0IHN0b3JhZ2VSZWYgPSBzdG9yYWdlLnJlZihcImdhbGxlcnlcIilcbmxldCBhc3luY0ZpbmlzaGVkID0gZmFsc2VcblxuLy9nZXQgZmlsdGVyIG9wdGlvbnNcbmxldCBmaWx0ZXJPcHRpb25zID0ge1xuICAgIGNvbG91cnM6IFtdLFxuICAgIG1hdGVyaWFsczogW10sXG4gICAgZnVybml0dXJlOiBbXCJjYWJpbmV0c1wiLCBcImNvdW50ZXJ0b3BcIl0sXG4gICAgcGF0dGVybjogbnVsbCxcbiAgICBsb2NhdGlvbnM6IFtdXG59XG5cbi8vYWN0aXZlIGZpbHRlcnNcbmxldCBhY3RpdmVGaWx0ZXJzID0ge1xuICAgIGNvbG91cnM6IFtdLFxuICAgIG1hdGVyaWFsczogW10sXG4gICAgY2FiaW5ldHM6IG51bGwsXG4gICAgY291bnRlcnRvcDogbnVsbCxcbiAgICBwYXR0ZXJuOiBudWxsLFxuICAgIGxvY2F0aW9uczogW11cbn1cblxuLy9pZiBhcnJheSBjb25haW5zIHRhcmdldFxuZnVuY3Rpb24gY29udGFpbnModGFyZ2V0LCBhcnJheSkge1xuICAgIGZvciAoY29uc3QgaSBvZiBhcnJheSkge1xuICAgICAgICBpZiAodGFyZ2V0ID09PSBpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZVxufVxuXG4vL3JlbW92ZSBlbGVtZW50IGZyb20gYXJyYXlcbmZ1bmN0aW9uIGFycmF5UmVtb3ZlKGFyciwgdmFsdWUpIHtcbiAgICByZXR1cm4gYXJyLmZpbHRlcihmdW5jdGlvbihlbGUpe1xuICAgICAgICByZXR1cm4gZWxlICE9IHZhbHVlXG4gICAgfSlcbn1cblxuLy9nZXQgcHJvamVjdHMgZnJvbSBmaXJlc3RvcmVcbmRiLmNvbGxlY3Rpb24oXCJnYWxsZXJ5XCIpLmdldCgpLnRoZW4oKHNuYXBzaG90KSA9PiB7XG4gICAgY29uc3QgaW5mb1R5cGVzID0gW1wiY29sb3VyXCIsIFwibWF0ZXJpYWxcIiwgXCJsb2NhdGlvblwiXVxuICAgIHNuYXBzaG90LmRvY3MuZm9yRWFjaChkb2MgPT4ge1xuICAgICAgICBkYXRhW2RvYy5pZF0gPSBkb2MuZGF0YSgpXG5cbiAgICAgICAgLy9nZXQgYWxsIHBvc3NpYmxlIGZpbHRlciBvcHRpb25zXG4gICAgICAgIGxldCBkZXRhaWxzID0gZG9jLmRhdGEoKS5kZXRhaWxzXG4gICAgICAgIGZvciAoY29uc3QgaW5mb1R5cGUgb2YgaW5mb1R5cGVzKSB7XG4gICAgICAgICAgICAvL2lmIGZpbHRlciBjYXRlZ29yeSBub3QgaW5jbHVkZWQgeWV0LCBwdXNoIGl0XG4gICAgICAgICAgICBpZiAoIShjb250YWlucyhkZXRhaWxzW2luZm9UeXBlXSwgZmlsdGVyT3B0aW9uc1tpbmZvVHlwZStcInNcIl0pKSkge1xuICAgICAgICAgICAgICAgIGZpbHRlck9wdGlvbnNbaW5mb1R5cGUrXCJzXCJdLnB1c2goZGV0YWlsc1tpbmZvVHlwZV0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgLy9jcmVhdGUgYnV0dG9ucyBmb3IgZmlsdGVyaW5nXG4gICAgZm9yIChjb25zdCBbY291bnQsIGluZm9UeXBlXSBvZiBpbmZvVHlwZXMuZW50cmllcygpKSB7IC8vaXRlcmF0ZSB0aHJvdWdoIGVhY2ggZmlsdGVyIHR5cGVcbiAgICAgICAgZm9yIChjb25zdCBpbmZvIG9mIGZpbHRlck9wdGlvbnNbaW5mb1R5cGUrXCJzXCJdKSB7IC8vd2l0aGluIHRoZXNlIHR5cGVzLCBnZXQgYWxsIGZpbHRlciBvcHRpb25zXG4gICAgICAgICAgICBsZXQgaWQgPSBpbmZvICsgXCJfXCIgKyBpbmZvVHlwZSAvL3VuaXF1ZSBpZCBmb3IgZWFjaCBidXR0b25cbiAgICAgICAgICAgICQoXCIjZmlsdGVyXCIgKyBjb3VudCkuYXBwZW5kKCAvL2NyZWF0ZSBidXR0b24gZm9yIHNlbGV0aW5nIGZpbHRlclxuICAgICAgICAgICAgICAgIFwiPGJ1dHRvbiBjbGFzcz1cXFwiZHJvcGRvd25fbWVudVxcXCIgaWQ9XCIgKyBpZCArIFwiPlwiICsgaW5mbyArIFwiPHNwYW4gc3R5bGU9XFxcImZsb2F0OiByaWdodDtcXFwiIGNsYXNzPVxcXCJtYXRlcmlhbC1pY29uc1xcXCI+ZG9uZTwvc3Bhbj48L2J1dHRvbj5cIlxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgbGV0IGZpbHRlcl9uYW1lID0gaW5mb1xuICAgICAgICAgICAgbGV0IGZpbHRlcl90eXBlID0gaW5mb1R5cGVcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGlkLmluY2x1ZGVzKFwiIFwiKSkge1xuICAgICAgICAgICAgICAgIGlkID0gXCJtaXhlZF9cIiArIGluZm9UeXBlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQoXCIjXCIraWQpLmNsaWNrKGZ1bmN0aW9uKCkgeyAvL2NyZWF0ZSBldmVudCBsaXN0ZW5lciBmb3JcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRhaW5zKGZpbHRlcl9uYW1lLCBhY3RpdmVGaWx0ZXJzW2ZpbHRlcl90eXBlK1wic1wiXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tmaWx0ZXJfdHlwZStcInNcIl0ucHVzaChmaWx0ZXJfbmFtZSlcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KFwiY2xlYXJcIilcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW2ZpbHRlcl90eXBlK1wic1wiXSA9IGFycmF5UmVtb3ZlKGFjdGl2ZUZpbHRlcnNbZmlsdGVyX3R5cGUrXCJzXCJdLCBmaWx0ZXJfbmFtZSlcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KFwiZG9uZVwiKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzcGxheV9iYXRjaChkYXRhKVxufSlcblxuLy9oYW5kbGUgZGF0YSBhbmQgZGlzcGxheSBpbWFnZXMgYWNjb3JkaW5nbHlcbmZ1bmN0aW9uIGRpc3BsYXlfYmF0Y2goZGF0YSkge1xuICAgIGFzeW5jRmluaXNoZWQgPSBmYWxzZVxuICAgIGZvciAobGV0IGtleSBpbiBkYXRhKSB7XG4gICAgICAgIGltZ1VSTCA9IHN0b3JhZ2VSZWYuY2hpbGQoZGF0YVtrZXldW1wiZmlsZVwiXSkgLy9pbWFnZSB1cmxcbiAgICAgICAgbGV0IGNvbHVtbiA9IGNvbHVtbnNbY29sdW1uTnVtJTRdIC8vY29sdW1uIHRvIGFwcGVuZCBpbWFnZSB0b1xuICAgICAgICBsZXQgaWQgPSBrZXkgLy9mb3IgYXN5bmNocm9udXMgZ2V0RG93bmxvYWRVUkxcbiAgICAgICAgaW1nVVJMLmdldERvd25sb2FkVVJMKCkudGhlbihmdW5jdGlvbih1cmwpIHtcbiAgICAgICAgICAgIC8vYXBwZW5kIGltYWdlIHRvIGNvbHVtblxuICAgICAgICAgICAgJChjb2x1bW4pLmFwcGVuZCggXG4gICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPVxcXCJpbWFnZV9jb250YWluZXJcXFwiIGlkPVwiICsgaWQgKyBcIj48aW1nIG9uY2xpY2s9XFxcImV4cGFuZChcIiArIGlkICsgXCIpXFxcInNyYz1cXFwiXCIrIHVybCArIFwiXFxcIi8+PC9kaXY+XCJcbiAgICAgICAgICAgIClcblxuICAgICAgICAgICAgLy9hdHRhY2ggaW5mb3JtYXRpb24gdG8gaW1hZ2VcbiAgICAgICAgICAgIGxldCBlbGVtZW50ID0gJChcIiNcIiArIGlkKSAvL3Nob3J0Y3V0IGZvciB0YXJnZXQgZWxlbWVudFxuXG4gICAgICAgICAgICAvL3ZhcmlhYmxlIGZvciBpbmZvcm1hdGlvblxuICAgICAgICAgICAgbGV0IGluZm8gPSBcIjxici8+Q29sb3VyOiBcIiArIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImNvbG91clwiXS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImNvbG91clwiXS5zbGljZSgxKSArIFwiPGJyLz5GdXJuaXR1cmU6IFwiXG5cbiAgICAgICAgICAgIC8vZnVybml0dXJlIHR5cGVcbiAgICAgICAgICAgIGlmIChkYXRhW2lkXVtcImRldGFpbHNcIl1bXCJmdXJuaXR1cmVcIl1bXCJjb3VudGVydG9wXCJdICYmIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImZ1cm5pdHVyZVwiXVtcImNhYmluZXRcIl0pIHtcbiAgICAgICAgICAgICAgICBpbmZvICs9IFwiQ291bnRlcnRvcCBhbmQgQ2FiaW5ldHMgXCJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YVtpZF1bXCJkZXRhaWxzXCJdW1wiZnVybml0dXJlXCJdW1wiY2FiaW5ldFwiXSkge1xuICAgICAgICAgICAgICAgIGluZm8gKz0gXCJDYWJpbmV0c1wiXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImZ1cm5pdHVyZVwiXVtcImNvdW50ZXJ0b3BcIl0pIHtcbiAgICAgICAgICAgICAgICBpbmZvICs9IFwiQ291bnRlcnRvcFwiXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vbG9jYXRpb25cbiAgICAgICAgICAgIGluZm8gKz0gXCI8YnIvPkxvY2F0aW9uOiBcIiArIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcImxvY2F0aW9uXCJdLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgZGF0YVtpZF1bXCJkZXRhaWxzXCJdW1wibG9jYXRpb25cIl0uc2xpY2UoMSlcbiAgICAgICAgICAgIC8vbWF0ZXJpYWxcbiAgICAgICAgICAgIGluZm8gKz0gXCI8YnIvPk1hdGVyaWFsOiBcIiArIGRhdGFbaWRdW1wiZGV0YWlsc1wiXVtcIm1hdGVyaWFsXCJdLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgZGF0YVtpZF1bXCJkZXRhaWxzXCJdW1wibWF0ZXJpYWxcIl0uc2xpY2UoMSlcbiAgICAgICAgICAgIC8vcGF0dGVyblxuICAgICAgICAgICAgaW5mbyArPSBcIjxici8+UGF0dGVybjogXCIgKyAoZGF0YVtpZF1bXCJkZXRhaWxzXCJdW1wicGF0dGVyblwiXSA/IFwiWWVzXCIgOiBcIk5vbmVcIilcblxuICAgICAgICAgICAgLy8gbGV0IHVzZXIgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXJcbiAgICAgICAgICAgIGxldCB1c2VyID0gbnVsbFxuICAgICAgICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZChcbiAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPVxcXCJkZXRhaWxzXFxcIj48cD5cIiArIGluZm8gKyBcIjxwPlwiICsgXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9XFxcInNsaWRlXFxcIj5cIiArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGlucHV0IHR5cGU9XFxcInJhbmdlXFxcIiBtaW49XFxcIjBcXFwiIG1heD1cXFwiMTBcXFwiIHZhbHVlPVxcXCI1XFxcIiBjbGFzcz1cXFwic2xpZGVyXFxcIj5cIiArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPHA+UmF0aW5nOiA8c3Bhbj48L3NwYW4+PC9wPlwiICsgXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGJ1dHRvbiBjbGFzcz1cXFwiYnRuIGJ0bi1zdWNjZXNzXFxcIj5TdWJtaXQ8L2J1dHRvbj5cIiArIFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICAgICAgLy9zbGlkZXJcbiAgICAgICAgICAgICAgICBsZXQgc2xpZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpXG4gICAgICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwic2xpZGVcIilbMF1cbiAgICAgICAgICAgICAgICAgICAgLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIilbMF1cblxuICAgICAgICAgICAgICAgIC8vc2xpZGUgdmFsdWVcbiAgICAgICAgICAgICAgICBsZXQgb3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpXG4gICAgICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwic2xpZGVcIilbMF1cbiAgICAgICAgICAgICAgICAgICAgLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwicFwiKVswXVxuICAgICAgICAgICAgICAgICAgICAuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzcGFuXCIpWzBdXG5cbiAgICAgICAgICAgICAgICAvL3N1Ym1pdCBidXR0b25cbiAgICAgICAgICAgICAgICBsZXQgYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpXG4gICAgICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnRuXCIpWzBdXG5cbiAgICAgICAgICAgICAgICBvdXRwdXQuaW5uZXJIVE1MID0gc2xpZGVyLnZhbHVlLzJcblxuICAgICAgICAgICAgICAgIHNsaWRlci5vbmlucHV0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dC5pbm5lckhUTUwgPSB0aGlzLnZhbHVlLzJcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF8gPT4geyAvL3N1Ym1pdCBidXR0b24gZnVuY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gc2xpZGVyLnZhbHVlIC8vdmFsdWUgb2Ygc2xpZGVyXG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciB1c2VySWQgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXIudWlkIC8vY3VycmVudCB1c2VyIGlkXG5cbiAgICAgICAgICAgICAgICAgICAgLy9yZWFkIFwicmF0aW5nc1wiIGZyb20gZGF0YWJhc2UgZm9yIHRoaXMgdXNlclxuICAgICAgICAgICAgICAgICAgICBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZihcIi91c2Vycy9cIiArIHVzZXJJZCArIFwiL3JhdGluZ3NcIikub25jZShcInZhbHVlXCIpLnRoZW4oZnVuY3Rpb24oc25hcHNob3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc2V0IG5ldyByYXRpbmdzXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmF0aW5ncyA9IG5ldyBNYXBcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gc25hcHNob3QudmFsKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYXRpbmdzW2ldID0gc25hcHNob3QudmFsKClbaV1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJhdGluZ3NbaWRdID0gdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKFwidXNlcnMvXCIgKyB1c2VySWQgKyBcIi9yYXRpbmdzXCIpLnNldCh7IC8vcHVzaCB0byBkYXRhYmFzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnJhdGluZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9hcHBlbmQgaW5mb3JtYXRpb24gdG8gZWxlbWVudFxuICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9XFxcImRldGFpbHNcXFwiPjxwPlwiICsgaW5mbyArIFwiPHA+XCJcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIGNvbHVtbk51bSsrXG4gICAgfVxuICAgIFByb21pc2UuYWxsKGNvbHVtbnMpLnRoZW4oKCkgPT4ge1xuICAgICAgICAvL3JlbW92ZSBsb2FkaW5nIGdpZlxuICAgICAgICAkKFwiI2xvYWRpbmdcIikuY3NzKFwiZGlzcGxheVwiLCBcIm5vbmVcIilcbiAgICB9KVxufVxuXG4vL21ha2VzIGluZm9ybWF0aW9uIGRyb3AgZG93blxuZnVuY3Rpb24gZXhwYW5kKGtleSkge1xuICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoa2V5KVxuICAgIGxldCBjb250YWluZXIgPSBlbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJkZXRhaWxzXCIpWzBdXG4gICAgaWYgKGNvbnRhaW5lci5zdHlsZS5tYXhIZWlnaHQpe1xuICAgICAgICBjb250YWluZXIuc3R5bGUubWF4SGVpZ2h0ID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb250YWluZXIuc3R5bGUubWF4SGVpZ2h0ID0gY29udGFpbmVyLnNjcm9sbEhlaWdodCArIFwicHhcIjtcbiAgICB9XG59XG5cbi8vZXhwYW5kIGZpbHRlciBkcm9wZG93blxuZnVuY3Rpb24gZXhwYW5kX2ZpbHRlcihudW1iKSB7XG4gICAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZpbHRlclwiK251bWIpXG4gICAgaWYgKGVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0KXtcbiAgICAgICAgZWxlbWVudC5zdHlsZS5tYXhIZWlnaHQgPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gZWxlbWVudC5zY3JvbGxIZWlnaHQgKyBcInB4XCI7XG4gICAgfVxufVxuXG4vL2FwcGx5IHRoZSBmaWx0ZXJzXG5mdW5jdGlvbiBhcHBseV9maWx0ZXJzKCkge1xuICAgIGNvbnN0IGZpbHRlclR5cGVzID0gW1wiY29sb3VyXCIsIFwibWF0ZXJpYWxcIiwgXCJsb2NhdGlvblwiXSAvL2ZpbHRlciBydHBlc1xuICAgICQoXCIuaW1hZ2VfY29udGFpbmVyXCIpLnJlbW92ZSgpIC8vZ2V0IHJpZCBvZiBhbGwgaW1hZ2VzIGluIGdhbGxlcnlcbiAgICAkKFwiI2xvYWRpbmdcIikuY3NzKFwiZGlzcGxheVwiLCBcImJsb2NrXCIpIC8vZGlzcGxheSBsb2FkaW5nIGdpZlxuICAgIGxldCBmaWx0ZXJlZERhdGEgPSBuZXcgTWFwIC8vbmV3IG1hcCBvZiBmaWx0ZXJlZCBkYXRhXG4gICAgY29uc29sZS5sb2coZGF0YSwgXCJEQVRBXCIpXG4gICAgZm9yIChsZXQga2V5IGluIGRhdGEpIHsgLy9pdGVyYXRlIHRocm91Z2ggZGF0YVxuICAgICAgICBsZXQgZG9jID0gZGF0YVtrZXldXG4gICAgICAgIGxldCBicm9rZW4gPSBmYWxzZVxuICAgICAgICBmb3IgKGNvbnN0IGZpbHRlciBvZiBmaWx0ZXJUeXBlcykgeyAvL21ha2Ugc3VyZSBkb2MgZG9lc25cInQgaGF2ZSBhdHRyaWJ1dGUgYXNzb3NpYXRlZCB3aXRoIGEgc2VsZWN0ZWQgZmlsdGVyXG4gICAgICAgICAgICBpZiAoY29udGFpbnMoZG9jW1wiZGV0YWlsc1wiXVtmaWx0ZXJdLCBhY3RpdmVGaWx0ZXJzW2ZpbHRlcitcInNcIl0pKSB7XG4gICAgICAgICAgICAgICAgYnJva2VuID0gdHJ1ZVxuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdGl2ZUZpbHRlcnNbXCJwYXR0ZXJuXCJdICE9PSBudWxsICYmIGRvY1tcImRldGFpbHNcIl1bXCJwYXR0ZXJuXCJdICE9PSBhY3RpdmVGaWx0ZXJzW1wicGF0dGVyblwiXSkge1xuICAgICAgICAgICAgYnJva2VuID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhY3RpdmVGaWx0ZXJzW1wiY291bnRlcnRvcFwiXSAhPT0gbnVsbCAmJiBhY3RpdmVGaWx0ZXJzW1wiY2FiaW5ldHNcIl0gIT09IG51bGwpIHtcbiAgICAgICAgICAgIGxldCBtYXRjaCA9IChcbiAgICAgICAgICAgICAgICBkb2NbXCJkZXRhaWxzXCJdW1wiZnVybml0dXJlXCJdW1wiY291bnRlcnRvcFwiXSAhPT0gYWN0aXZlRmlsdGVyc1tcImNvdW50ZXJ0b3BcIl0gfHxcbiAgICAgICAgICAgICAgICBkb2NbXCJkZXRhaWxzXCJdW1wiZnVybml0dXJlXCJdW1wiY2FiaW5ldFwiXSAhPT0gYWN0aXZlRmlsdGVyc1tcImNhYmluZXRzXCJdXG4gICAgICAgICAgICApXG4gICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICBicm9rZW4gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFicm9rZW4pIHsgLy9pZiBkYXRhIGlzblwidCBmaWx0ZXJlZCwgYWRkIGl0IHRvIGZpbHRlcmVkIGRhdGFcbiAgICAgICAgICAgIGZpbHRlcmVkRGF0YVtrZXldID0gZG9jXG4gICAgICAgIH1cbiAgICB9XG4gICAgZGlzcGxheV9iYXRjaChmaWx0ZXJlZERhdGEpIC8vZGlzcGxheSBmaWx0ZXJlZCBkYXRhXG59XG5cbmZ1bmN0aW9uIGNsZWFyX2ZpbHRlcnMoKSB7XG4gICAgJChcIi5pbWFnZV9jb250YWluZXJcIikucmVtb3ZlKCkgLy9nZXQgcmlkIG9mIGFsbCBpbWFnZXMgaW4gZ2FsbGVyeVxuICAgICQoXCIjbG9hZGluZ1wiKS5jc3MoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIikgLy9kaXNwbGF5IGxvYWRpbmcgZ2lmXG4gICAgJChcIi5kcm9wZG93bl9tZW51XCIpLmVhY2goZnVuY3Rpb24oKSB7IC8vY2hhbmdlIGFsbCB4IHRvIGNoZWNrbWFya3NcbiAgICAgICAgaWYgKCQodGhpcykuZmluZChcInNwYW5cIikudGV4dCgpID09IFwiY2xlYXJcIikge1xuICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KFwiZG9uZVwiKVxuICAgICAgICB9XG4gICAgfSlcbiAgICAkKFwiI3BhdHRlcm5fdG9nZ2xlXCIpLmZpbmQoXCJzcGFuXCIpLnRleHQoXCJyZW1vdmVcIilcbiAgICAvL3Jlc2V0IGFjdGl2ZSBmaWx0ZXJzXG4gICAgYWN0aXZlRmlsdGVycyA9IHtcbiAgICAgICAgY29sb3VyczogW10sXG4gICAgICAgIG1hdGVyaWFsczogW10sXG4gICAgICAgIGNhYmluZXRzOiBudWxsLFxuICAgICAgICBjb3VudGVydG9wOiBudWxsLFxuICAgICAgICBwYXR0ZXJuOiBudWxsLFxuICAgICAgICBsb2NhdGlvbnM6IFtdXG4gICAgfVxuICAgIGRpc3BsYXlfYmF0Y2goZGF0YSlcbn1cblxuJChcImRvY3VtZW50XCIpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgIC8vdG9nZ2xlciBmb3IgcGF0dGVybiBmaXRsZXJcbiAgICAkKFwiI3BhdHRlcm5fdG9nZ2xlXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KCkgPT09IFwicmVtb3ZlXCIpIHsgLy9pZiBjdXJyZW50IHNldHRpbmcgaXMgZWl0aGVyIG9yXG4gICAgICAgICAgICAkKHRoaXMpLmZpbmQoXCJzcGFuXCIpLnRleHQoXCJjbGVhclwiKVxuICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcInBhdHRlcm5cIl0gPSBmYWxzZVxuXG4gICAgICAgIH0gZWxzZSBpZiAoJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KCkgPT09IFwiY2xlYXJcIikgeyAvL2lmIGN1cnJlbnQgc2V0dGluZyBpcyBubyBwYXR0ZXJuXG4gICAgICAgICAgICAkKHRoaXMpLmZpbmQoXCJzcGFuXCIpLnRleHQoXCJkb25lXCIpXG4gICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wicGF0dGVyblwiXSA9IHRydWVcblxuICAgICAgICB9IGVsc2UgaWYgKCQodGhpcykuZmluZChcInNwYW5cIikudGV4dCgpID09PSBcImRvbmVcIikgeyAvL2lmIGN1cnJlbnQgc2V0dGluZyBpcyB3aXRoIGEgcGF0dGVyblxuICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KFwicmVtb3ZlXCIpXG4gICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wicGF0dGVyblwiXSA9IG51bGxcbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICAvL3RvZ2dsZXIgZm9yIGZ1cm5pdHVyZSB0eXBlc1xuICAgIGNvbnN0IGZ1cm5pdHVyZV9kcm9wZG93bnMgPSBbXCJlaXRoZXJcIiwgXCJib3RoXCIsIFwiY291bnRlcnRvcFwiLCBcImNhYmluZXRzXCJdXG4gICAgJChcIi5mdXJuaXR1cmVfZHJvcGRvd25cIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgJCh0aGlzKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBmdXJuaXR1cmVfZHJvcGRvd25zKSB7XG4gICAgICAgICAgICAgICAgJChcIiNcIiArIGkgKyBcIl9mdXJuaXR1cmVcIikuZmluZChcInNwYW5cIikudGV4dChcIlwiKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJCh0aGlzKS5maW5kKFwic3BhblwiKS50ZXh0KFwiZG9uZVwiKVxuICAgICAgICAgICAgbGV0IGlkID0gJCh0aGlzKS5hdHRyKFwiaWRcIilcbiAgICAgICAgICAgIGlkID0gaWQucmVwbGFjZShcIl9mdXJuaXR1cmVcIiwgXCJcIilcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGlkKVxuXG4gICAgICAgICAgICBpZiAoaWQgPT09IFwiYm90aFwiKSB7IC8vaWYgY3VycmVudCBzZXR0aW5nIGlzIGJvdGggY291bnRlcnRvcHMgYW5kIGNhYmluZXRzXG4gICAgICAgICAgICAgICAgYWN0aXZlRmlsdGVyc1tcImNhYmluZXRzXCJdID0gdHJ1ZVxuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJjb3VudGVydG9wXCJdID0gdHJ1ZVxuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSBcImVpdGhlclwiKSB7IC8vaWYgY3VycmVudCBzZXR0aW5nIGlzIGVpdGhlciBjb3VudGVydG9wcyBvciBjYWJpbmV0c1xuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJjYWJpbmV0c1wiXSA9IG51bGxcbiAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wiY291bnRlcnRvcFwiXSA9IG51bGxcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09IFwiY291bnRlcnRvcFwiKSB7IC8vaWYgY3VycmVudCBzZXR0aW5nIGlzIGNvdW50ZXJ0b3BzIG9ubHlcbiAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wiY2FiaW5ldHNcIl0gPSBmYWxzZVxuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJjb3VudGVydG9wXCJdID0gdHJ1ZVxuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSBcImNhYmluZXRzXCIpIHsgLy9pZiBjdXJyZW50IHNldHRpbmcgaXMgY2FiaW5ldHMgb25seVxuICAgICAgICAgICAgICAgIGFjdGl2ZUZpbHRlcnNbXCJjYWJpbmV0c1wiXSA9IHRydWVcbiAgICAgICAgICAgICAgICBhY3RpdmVGaWx0ZXJzW1wiY291bnRlcnRvcFwiXSA9IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImFjdGl2ZUZpbHRlcnNcIiwgYWN0aXZlRmlsdGVycylcbiAgICAgICAgfSlcbiAgICB9KVxufSkiXX0=